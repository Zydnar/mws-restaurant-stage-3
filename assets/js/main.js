!function i(o,s,u){function a(r,t){if(!s[r]){if(!o[r]){var e="function"==typeof require&&require;if(!t&&e)return e(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+r+"'")}var n=s[r]={exports:{}};o[r][0].call(n.exports,function(t){var e=o[r][1][t];return a(e||t)},n,n.exports,i,o,s,u)}return s[r].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,r,n){(function(Me){"use strict";var t,e,Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e=function(){var G=Object.keys,Q=Array.isArray,Z="undefined"!=typeof self?self:"undefined"!=typeof window?window:Me;function tt(e,r){return"object"!==(void 0===r?"undefined":Re(r))||G(r).forEach(function(t){e[t]=r[t]}),e}var i=Object.getPrototypeOf,r={}.hasOwnProperty;function et(t,e){return r.call(t,e)}function rt(e,r){"function"==typeof r&&(r=r(i(e))),G(r).forEach(function(t){nt(e,t,r[t])})}var o=Object.defineProperty;function nt(t,e,r,n){o(t,e,tt(r&&et(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function s(e){return{from:function(t){return e.prototype=Object.create(t.prototype),nt(e.prototype,"constructor",e),{extend:rt.bind(null,e.prototype)}}}}var u=Object.getOwnPropertyDescriptor;var n=[].slice;function it(t,e,r){return n.call(t,e,r)}function ot(t,e){return e(t)}function st(t){if(!t)throw new Error("Assertion Failed")}function a(t){Z.setImmediate?setImmediate(t):setTimeout(t,0)}function ut(t,i){return t.reduce(function(t,e,r){var n=i(e,r);return n&&(t[n[0]]=n[1]),t},{})}function at(t,e){return function(){try{t.apply(this,arguments)}catch(t){e(t)}}}function ct(t,e,r){try{t.apply(null,r)}catch(t){e&&e(t)}}function lt(t,e){if(et(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var r=[],n=0,i=e.length;n<i;++n){var o=lt(t,e[n]);r.push(o)}return r}var s=e.indexOf(".");if(-1!==s){var u=t[e.substr(0,s)];return void 0===u?void 0:lt(u,e.substr(s+1))}}function ft(t,e,r){if(t&&void 0!==e&&!("isFrozen"in Object&&Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){st("string"!=typeof r&&"length"in r);for(var n=0,i=e.length;n<i;++n)ft(t,e[n],r[n])}else{var o=e.indexOf(".");if(-1!==o){var s=e.substr(0,o),u=e.substr(o+1);if(""===u)void 0===r?delete t[s]:t[s]=r;else{var a=t[s];a||(a=t[s]={}),ft(a,u,r)}}else void 0===r?delete t[e]:t[e]=r}}function ht(t){var e={};for(var r in t)et(t,r)&&(e[r]=t[r]);return e}var e=[].concat;function pt(t){return e.apply([],t)}var c="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(pt([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(t){return Z[t]}).map(function(t){return Z[t]});function dt(t){if(!t||"object"!==(void 0===t?"undefined":Re(t)))return t;var e;if(Q(t)){e=[];for(var r=0,n=t.length;r<n;++r)e.push(dt(t[r]))}else if(0<=c.indexOf(t.constructor))e=t;else for(var i in e=t.constructor?Object.create(t.constructor.prototype):{},t)et(t,i)&&(e[i]=dt(t[i]));return e}function bt(n,i,o,s){return o=o||{},s=s||"",G(n).forEach(function(t){if(et(i,t)){var e=n[t],r=i[t];"object"===(void 0===e?"undefined":Re(e))&&"object"===(void 0===r?"undefined":Re(r))&&e&&r&&""+e.constructor==""+r.constructor?bt(e,r,o,s+t+"."):e!==r&&(o[s+t]=i[t])}else o[s+t]=void 0}),G(i).forEach(function(t){et(n,t)||(o[s+t]=i[t])}),o}var l="undefined"!=typeof Symbol&&Symbol.iterator,f=l?function(t){var e;return null!=t&&(e=t[l])&&e.apply(t)}:function(){return null},vt={};function yt(t){var e,r,n,i;if(1===arguments.length){if(Q(t))return t.slice();if(this===vt&&"string"==typeof t)return[t];if(i=f(t)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==t)return[t];if("number"==typeof(e=t.length)){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var mt="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function h(t,e){mt=t,p=e}var p=function(){return!0},t=!new Error("").stack;function gt(){if(t)try{throw new Error}catch(t){return t}return new Error}function wt(t,e){var r=t.stack;return r?(e=e||0,0===r.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),r.split("\n").slice(e).filter(p).map(function(t){return"\n"+t}).join("")):""}var d=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],b=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(d),v={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function y(t,e){this._e=gt(),this.name=t,this.message=e}function _t(t,e,r,n){this._e=gt(),this.failures=e,this.failedKeys=n,this.successCount=r}function Ot(t,e){this._e=gt(),this.name="BulkError",this.failures=e,this.message=t+". Errors: "+e.map(function(t){return t.toString()}).filter(function(t,e,r){return r.indexOf(t)===e}).join("\n")}s(y).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+wt(this._e,2))}},toString:function(){return this.name+": "+this.message}}),s(_t).from(y),s(Ot).from(y);var m=b.reduce(function(t,e){return t[e]=e+"Error",t},{}),g=y,xt=b.reduce(function(t,r){var n=r+"Error";function e(t,e){this._e=gt(),this.name=n,t?"string"==typeof t?(this.message=t,this.inner=e||null):"object"===(void 0===t?"undefined":Re(t))&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=v[r]||n,this.inner=null)}return s(e).from(g),t[r]=e,t},{});xt.Syntax=SyntaxError,xt.Type=TypeError,xt.Range=RangeError;var w=d.reduce(function(t,e){return t[e+"Error"]=xt[e],t},{});var _=b.reduce(function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=xt[e]),t},{});function St(){}function Et(t){return t}function jt(e,r){return null==e||e===Et?r:function(t){return r(e(t))}}function O(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function kt(i,o){return i===St?o:function(){var t=i.apply(this,arguments);void 0!==t&&(arguments[0]=t);var e=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var n=o.apply(this,arguments);return e&&(this.onsuccess=this.onsuccess?O(e,this.onsuccess):e),r&&(this.onerror=this.onerror?O(r,this.onerror):r),void 0!==n?n:t}}function At(r,n){return r===St?n:function(){r.apply(this,arguments);var t=this.onsuccess,e=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?O(t,this.onsuccess):t),e&&(this.onerror=this.onerror?O(e,this.onerror):e)}}function Tt(o,s){return o===St?s:function(t){var e=o.apply(this,arguments);tt(t,e);var r=this.onsuccess,n=this.onerror;this.onsuccess=null,this.onerror=null;var i=s.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?O(r,this.onsuccess):r),n&&(this.onerror=this.onerror?O(n,this.onerror):n),void 0===e?void 0===i?void 0:i:tt(e,i)}}function x(t,e){return t===St?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function Pt(i,o){return i===St?o:function(){var t=i.apply(this,arguments);if(t&&"function"==typeof t.then){for(var e=this,r=arguments.length,n=new Array(r);r--;)n[r]=arguments[r];return t.then(function(){return o.apply(e,n)})}return o.apply(this,arguments)}}_.ModifyError=_t,_.DexieError=y,_.BulkError=Ot;var S={},E=100,j=7,k=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=Z.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),A=k[0],T=k[1],P=k[2],I=T&&T.then,It=A&&A.constructor,Mt=k[3],M=!!P,R=!1,D=P?function(){P.then(Ct)}:Z.setImmediate?setImmediate.bind(null,Ct):Z.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Ct(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Ct,0)},N=function(t,e){U.push([t,e]),C&&(D(),C=!1)},B=!0,C=!0,L=[],F=[],H=null,q=Et,K={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{se(t[0],t[1])}catch(t){}})}},Rt=K,U=[],W=0,V=[];function Dt(t){if("object"!==Re(this))throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=St,this._lib=!1;var e=this._PSD=Rt;if(mt&&(this._stackHolder=gt(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==S)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Y(this,this._value))}this._state=null,this._value=null,++e.ref,function e(n,t){try{t(function(r){if(null===n._state){if(r===n)throw new TypeError("A promise cannot be resolved with itself.");var t=n._lib&&Lt();r&&"function"==typeof r.then?e(n,function(t,e){r instanceof Dt?r._then(t,e):r.then(t,e)}):(n._state=!0,n._value=r,$(n)),t&&Ft()}},Y.bind(null,n))}catch(t){Y(n,t)}}(this,t)}var z={get:function(){var s=Rt,e=Xt;function t(r,n){var i=this,o=!s.global&&(s!==Rt||e!==Xt);o&&Gt();var t=new Dt(function(t,e){J(i,new X(ne(r,s,o),ne(n,s,o),t,e,s))});return mt&&Bt(t,this),t}return t.prototype=S,t},set:function(t){nt(this,"then",t&&t.prototype===S?z:{get:function(){return t},set:z.set})}};function X(t,e,r,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=r,this.reject=n,this.psd=i}function Y(e,r){if(F.push(r),null===e._state){var n,t=e._lib&&Lt();r=q(r),e._state=!1,e._value=r,mt&&null!==r&&"object"===(void 0===r?"undefined":Re(r))&&!r._promise&&ct(function(){var t=function t(e,r){var n;return u(e,r)||(n=i(e))&&t(n,r)}(r,"stack");r._promise=e,nt(r,"stack",{get:function(){return R?t&&(t.get?t.get.apply(r):t.value):e.stack}})}),n=e,L.some(function(t){return t._value===n._value})||L.push(n),$(e),t&&Ft()}}function $(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)J(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),0===W&&(++W,N(function(){0==--W&&Ht()},[]))}function J(t,e){if(null!==t._state){var r=t._state?e.onFulfilled:e.onRejected;if(null===r)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++W,N(Nt,[r,t,e])}else t._listeners.push(e)}function Nt(t,e,r){try{var n,i=(H=e)._value;e._state?n=t(i):(F.length&&(F=[]),n=t(i),-1===F.indexOf(i)&&function(t){var e=L.length;for(;e;)if(L[--e]._value===t._value)return L.splice(e,1)}(e)),r.resolve(n)}catch(t){r.reject(t)}finally{H=null,0==--W&&Ht(),--r.psd.ref||r.psd.finalize()}}function Bt(t,e){var r=e?e._numPrev+1:0;r<E&&(t._prev=e,t._numPrev=r)}function Ct(){Lt()&&Ft()}function Lt(){var t=B;return C=B=!1,t}function Ft(){var t,e,r;do{for(;0<U.length;)for(t=U,U=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}}while(0<U.length);C=B=!0}function Ht(){var t=L;L=[],t.forEach(function(t){t._PSD.onunhandled.call(null,t._value,t)});for(var e=V.slice(0),r=e.length;r;)e[--r]()}function qt(t){return new Dt(S,!1,t)}function Kt(r,n){var i=Rt;return function(){var t=Lt(),e=Rt;try{return te(i,!0),r.apply(this,arguments)}catch(t){n&&n(t)}finally{te(e,!1),t&&Ft()}}}rt(Dt.prototype,{then:z,_then:function(t,e){J(this,new X(null,null,t,e,Rt))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=t,r=arguments[1];return"function"==typeof e?this.then(null,function(t){return t instanceof e?r(t):qt(t)}):this.then(null,function(t){return t&&t.name===e?r(t):qt(t)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),qt(t)})},stack:{get:function(){if(this._stack)return this._stack;try{R=!0;var t=function t(e,r,n){if(r.length===n)return r;var i="";if(!1===e._state){var o,s,u=e._value;null!=u?(o=u.name||"Error",s=u.message||u,i=wt(u,0)):(o=u,s=""),r.push(o+(s?": "+s:"")+i)}mt&&((i=wt(e._stackHolder,2))&&-1===r.indexOf(i)&&r.push(i),e._prev&&t(e._prev,r,n));return r}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{R=!1}}},timeout:function(n,i){var o=this;return n<1/0?new Dt(function(t,e){var r=setTimeout(function(){return e(new xt.Timeout(i))},n);o.then(t,e).finally(clearTimeout.bind(null,r))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&nt(Dt.prototype,Symbol.toStringTag,"Promise"),K.env=ee(),rt(Dt,{all:function(){var o=yt.apply(null,arguments).map(Qt);return new Dt(function(r,n){0===o.length&&r([]);var i=o.length;o.forEach(function(t,e){return Dt.resolve(t).then(function(t){o[e]=t,--i||r(o)},n)})})},resolve:function(r){if(r instanceof Dt)return r;if(r&&"function"==typeof r.then)return new Dt(function(t,e){r.then(t,e)});var t=new Dt(S,!0,r);return Bt(t,H),t},reject:qt,race:function(){var t=yt.apply(null,arguments).map(Qt);return new Dt(function(e,r){t.map(function(t){return Dt.resolve(t).then(e,r)})})},PSD:{get:function(){return Rt},set:function(t){return Rt=t}},newPSD:$t,usePSD:re,scheduler:{get:function(){return N},set:function(t){N=t}},rejectionMapper:{get:function(){return q},set:function(t){q=t}},follow:function(i,r){return new Dt(function(t,e){return $t(function(r,n){var t=Rt;t.unhandleds=[],t.onunhandled=n,t.finalize=O(function(){var e,t=this;e=function(){0===t.unhandleds.length?r():n(t.unhandleds[0])},V.push(function t(){e(),V.splice(V.indexOf(t),1)}),++W,N(function(){0==--W&&Ht()},[])},t.finalize),i()},r,t,e)})}});var Ut={awaits:0,echoes:0,id:0},Wt=0,Vt=[],zt=0,Xt=0,Yt=0;function $t(t,e,r,n){var i=Rt,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Yt;var s=K.env;o.env=M?{Promise:Dt,PromiseProp:{value:Dt,configurable:!0,writable:!0},all:Dt.all,race:Dt.race,resolve:Dt.resolve,reject:Dt.reject,nthen:ie(s.nthen,o),gthen:ie(s.gthen,o)}:{},e&&tt(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=re(o,t,r,n);return 0===o.ref&&o.finalize(),u}function Jt(){return Ut.id||(Ut.id=++Wt),++Ut.awaits,Ut.echoes+=j,Ut.id}function Gt(t){!Ut.awaits||t&&t!==Ut.id||(0==--Ut.awaits&&(Ut.id=0),Ut.echoes=Ut.awaits*j)}function Qt(t){return Ut.echoes&&t&&t.constructor===It?(Jt(),t.then(function(t){return Gt(),t},function(t){return Gt(),ue(t)})):t}function Zt(){var t=Vt[Vt.length-1];Vt.pop(),te(t,!1)}function te(t,e){var r,n=Rt;if((e?!Ut.echoes||zt++&&t===Rt:!zt||--zt&&t===Rt)||(r=e?function(t){++Xt,Ut.echoes&&0!=--Ut.echoes||(Ut.echoes=Ut.id=0),Vt.push(Rt),te(t,!0)}.bind(null,t):Zt,I.call(A,r)),t!==Rt&&(Rt=t,n===K&&(K.env=ee()),M)){var i=K.env.Promise,o=t.env;T.then=o.nthen,i.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(Z,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject)}}function ee(){var t=Z.Promise;return M?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Z,"Promise"),all:t.all,race:t.race,resolve:t.resolve,reject:t.reject,nthen:T.then,gthen:t.prototype.then}:{}}function re(t,e,r,n,i){var o=Rt;try{return te(t,!0),e(r,n,i)}finally{te(o,!1)}}function ne(e,r,n){return"function"!=typeof e?e:function(){var t=Rt;n&&Jt(),te(r,!0);try{return e.apply(this,arguments)}finally{te(t,!1)}}}function ie(r,n){return function(t,e){return r.call(this,ne(t,n,!1),ne(e,n,!1))}}var oe="unhandledrejection";function se(t,e){var r;try{r=e.onuncatched(t)}catch(t){}if(!1!==r)try{var n,i={promise:e,reason:t};if(Z.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(oe,!0,!0),tt(n,i)):Z.CustomEvent&&tt(n=new CustomEvent(oe,{detail:i}),i),n&&Z.dispatchEvent&&(dispatchEvent(n),!Z.PromiseRejectionEvent&&Z.onunhandledrejection))try{Z.onunhandledrejection(n)}catch(t){}n.defaultPrevented||console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var ue=Dt.reject;function ae(i){var s={},e=function(t,e){if(e){for(var r=arguments.length,n=new Array(r-1);--r;)n[r-1]=arguments[r];return s[t].subscribe.apply(null,n),i}if("string"==typeof t)return s[t]};e.addEventType=u;for(var t=1,r=arguments.length;t<r;++t)u(arguments[t]);return e;function u(t,r,n){if("object"!==(void 0===t?"undefined":Re(t))){var i;r||(r=x),n||(n=St);var o={subscribers:[],fire:n,subscribe:function(t){-1===o.subscribers.indexOf(t)&&(o.subscribers.push(t),o.fire=r(o.fire,t))},unsubscribe:function(e){o.subscribers=o.subscribers.filter(function(t){return t!==e}),o.fire=o.subscribers.reduce(r,n)}};return s[t]=e[t]=o,o}G(i=t).forEach(function(t){var e=i[t];if(Q(e))u(t,i[t][0],i[t][1]);else{if("asap"!==e)throw new xt.InvalidArgument("Invalid event config");var r=u(t,Et,function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];r.subscribers.forEach(function(t){a(function(){t.apply(null,e)})})})}})}}var ce,le=String.fromCharCode(65535),fe=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(t){return le}}(),he=-1/0,pe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",de="String expected.",be=[],ve="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ye=ve,me=ve,ge=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function we(o,t){var e,r,f,n,i,s=we.dependencies,u=tt({addons:we.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},t),a=u.addons,c=u.autoOpen,l=u.indexedDB,g=u.IDBKeyRange,h=this._dbSchema={},p=[],d=[],b={},v=null,y=null,m=!1,w=null,_=!1,O="readonly",x="readwrite",S=this,E=new Dt(function(t){e=t}),j=new Dt(function(t,e){r=e}),k=!0,A=!!Ie(l);function T(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function P(t,e,r){var n=S._createTransaction(x,d,h);n.create(e),n._completion.catch(r);var i=n._reject.bind(n);$t(function(){Rt.trans=n,0===t?(G(h).forEach(function(t){I(e,t,h[t].primKey,h[t].indexes)}),Dt.follow(function(){return S.on.populate.fire(n)}).catch(i)):function(e,i,o){var r=[],t=p.filter(function(t){return t._cfg.version===e})[0];if(!t)throw new xt.Upgrade("Dexie specification of currently installed DB version is missing");h=S._dbSchema=t._cfg.dbschema;var s=!1;return p.filter(function(t){return t._cfg.version>e}).forEach(function(n){r.push(function(){var t=h,e=n._cfg.dbschema;$(t,o),$(e,o),h=S._dbSchema=e;var r=function(t,e){var r={del:[],add:[],change:[]};for(var n in t)e[n]||r.del.push(n);for(n in e){var i=t[n],o=e[n];if(i){var s={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)s.recreate=!0,r.change.push(s);else{var u=i.idxByName,a=o.idxByName;for(var c in u)a[c]||s.del.push(c);for(c in a){var l=u[c],f=a[c];l?l.src!==f.src&&s.change.push(f):s.add.push(f)}(0<s.del.length||0<s.add.length||0<s.change.length)&&r.change.push(s)}}else r.add.push([n,o])}return r}(t,e);if(r.add.forEach(function(t){I(o,t[0],t[1].primKey,t[1].indexes)}),r.change.forEach(function(t){if(t.recreate)throw new xt.Upgrade("Not yet support for changing primary key");var e=o.objectStore(t.name);t.add.forEach(function(t){M(e,t)}),t.change.forEach(function(t){e.deleteIndex(t.name),M(e,t)}),t.del.forEach(function(t){e.deleteIndex(t)})}),n._cfg.contentUpgrade)return s=!0,Dt.follow(function(){n._cfg.contentUpgrade(i)})}),r.push(function(t){s&&ye||function(t,e){for(var r=0;r<e.db.objectStoreNames.length;++r){var n=e.db.objectStoreNames[r];null==t[n]&&e.db.deleteObjectStore(n)}}(n._cfg.dbschema,t)})}),function t(){return r.length?Dt.resolve(r.shift()(i.idbtrans)).then(t):Dt.resolve()}().then(function(){var e,r;r=o,G(e=h).forEach(function(t){r.db.objectStoreNames.contains(t)||I(r,t,e[t].primKey,e[t].indexes)})})}(t,n,e).catch(i)})}function I(t,e,r,n){var i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(t){M(i,t)}),i}function M(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function R(t,e,r){this.name=t,this.schema=e,this._tx=r,this.hook=b[t]?b[t].hook:ae(null,{creating:[kt,St],reading:[jt,Et],updating:[Tt,St],deleting:[At,St]})}function D(e,r,t){return(t?Ee:xe)(function(t){e.push(t),r&&r()})}function N(c,l,f,h,p){return new Dt(function(n,t){var i=f.length,o=i-1;if(0===i)return n();if(h){var s,u=Ee(t),a=Oe(null);ct(function(){for(var t=0;t<i;++t){s={onsuccess:null,onerror:null};var e=f[t];p.call(s,e[0],e[1],l);var r=c.delete(e[0]);r._hookCtx=s,r.onerror=u,r.onsuccess=t===o?Oe(n):a}},function(t){throw s.onerror&&s.onerror(t),t})}else for(var e=0;e<i;++e){var r=c.delete(f[e]);r.onerror=xe(t),e===o&&(r.onsuccess=Kt(function(){return n()}))}})}function B(t,e,r,n){var i=this;this.db=S,this.mode=t,this.storeNames=e,this.idbtrans=null,this.on=ae(this,"complete","error","abort"),this.parent=n||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Dt(function(t,e){i._resolve=t,i._reject=e}),this._completion.then(function(){i.active=!1,i.on.complete.fire()},function(t){var e=i.active;return i.active=!1,i.on.error.fire(t),i.parent?i.parent._reject(t):e&&i.idbtrans&&i.idbtrans.abort(),ue(t)})}function C(t,e,r){this._ctx={table:t,index:":id"===e?null:e,or:r}}function L(t,e){var r=null,n=null;if(e)try{r=e()}catch(t){n=t}var i=t._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:o.hook.reading.fire}}function F(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function H(t,e){return t._cfg.version-e._cfg.version}function q(t,e,n){e.forEach(function(e){var r=n[e];t.forEach(function(t){e in t||(t===B.prototype||t instanceof B?nt(t,e,{get:function(){return this.table(e)}}):t[e]=new R(e,r))})})}function K(r,n,i,o,s,u){var a=Kt(u?function(t,e,r){return i(u(t),e,r)}:i,s);r.onerror||(r.onerror=xe(s)),r.onsuccess=at(n?function(){var t=r.result;if(t){var e=function(){t.continue()};n(t,function(t){e=t},o,s)&&a(t.value,t,function(t){e=t}),e()}else o()}:function(){var t=r.result;if(t){var e=function(){t.continue()};a(t.value,t,function(t){e=t}),e()}else o()},s)}function U(t,e){return l.cmp(t,e)}function W(t,e){return l.cmp(t,e)}function V(t,e){return l.cmp(e,t)}function z(t,e){return t<e?-1:t===e?0:1}function X(t,e){return e<t?-1:t===e?0:1}function Y(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}function $(t,e){for(var r=e.db.objectStoreNames,n=0;n<r.length;++n){var i=r[n],o=e.objectStore(i);f="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var u=o.indexNames[s],a=o.index(u).keyPath,c="string"==typeof a?a:"["+it(a).join("+")+"]";if(t[i]){var l=t[i].idxByName[c];l&&(l.name=u)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Z.WorkerGlobalScope&&Z instanceof Z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(f=!1)}function J(e){S.on("blocked").fire(e),be.filter(function(t){return t.name===S.name&&t!==S&&!t._vcFired}).map(function(t){return t.on("versionchange").fire(e)})}this.version=function(e){if(v||m)throw new xt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=p.filter(function(t){return t._cfg.version===e})[0];return t||(t=new T(e),p.push(t),p.sort(H),k=!1,t)},tt(T.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?tt(this._cfg.storesSource,t):t;var e={};p.forEach(function(t){tt(e,t._cfg.storesSource)});var r=this._cfg.dbschema={};return this._parseStoresSpec(e,r),h=S._dbSchema=r,[b,S,B.prototype].forEach(function(t){for(var e in t)t[e]instanceof R&&delete t[e]}),q([b,S,B.prototype,this._cfg.tables],G(r),r),d=G(r),this},upgrade:function(t){return this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(s,u){G(s).forEach(function(t){if(null!==s[t]){var e={},r=(i=s[t],o=[],i.split(",").forEach(function(t){var e=(t=t.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(e)?e.match(/^\[(.*)\]$/)[1].split("+"):e;o.push(new Ae(e,r||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),Q(r),/\./.test(t)))}),o),n=r.shift();if(n.multi)throw new xt.Schema("Primary key cannot be multi-valued");n.keyPath&&ft(e,n.keyPath,n.auto?0:n.keyPath),r.forEach(function(t){if(t.auto)throw new xt.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new xt.Schema("Index must have a name and cannot be an empty string");ft(e,t.keyPath,t.compound?t.keyPath.map(function(){return""}):"")}),u[t]=new Te(t,n,r,e)}var i,o})}}),this._allTables=b,this._createTransaction=function(t,e,r,n){return new B(t,e,r,n)},this._whenReady=function(t){return _||Rt.letThrough?t():new Dt(function(t,e){if(!m){if(!c)return void e(new xt.DatabaseClosed);S.open().catch(St)}E.then(t,e)}).then(t)},this.verno=0,this.open=function(){if(m||v)return E.then(function(){return y?ue(y):S});mt&&(j._stackHolder=gt()),_=!(m=!0);var t=e,i=y=null;return Dt.race([j,new Dt(function(t,r){if(!l)throw new xt.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var n=k?l.open(o):l.open(o,Math.round(10*S.verno));if(!n)throw new xt.MissingAPI("IndexedDB API not available");n.onerror=xe(r),n.onblocked=Kt(J),n.onupgradeneeded=Kt(function(t){if(i=n.transaction,k&&!S._allowEmptyDB){n.onerror=je,i.abort(),n.result.close();var e=l.deleteDatabase(o);e.onsuccess=e.onerror=Kt(function(){r(new xt.NoSuchDatabase("Database "+o+" doesnt exist"))})}else{i.onerror=xe(r),P((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,i,r)}},r),n.onsuccess=Kt(function(){if(i=null,v=n.result,be.push(S),k)!function(){if(S.verno=v.version/10,S._dbSchema=h={},0===(d=it(v.objectStoreNames,0)).length)return;var c=v.transaction(Pe(d),"readonly");d.forEach(function(t){for(var e=c.objectStore(t),r=e.keyPath,n=r&&"string"==typeof r&&-1!==r.indexOf("."),i=new Ae(r,r||"",!1,!1,!!e.autoIncrement,r&&"string"!=typeof r,n),o=[],s=0;s<e.indexNames.length;++s){var u=e.index(e.indexNames[s]);r=u.keyPath,n=r&&"string"==typeof r&&-1!==r.indexOf(".");var a=new Ae(u.name,r,!!u.unique,!!u.multiEntry,!1,r&&"string"!=typeof r,n);o.push(a)}h[t]=new Te(t,i,o,{})}),q([b],G(h),h)}();else if(0<v.objectStoreNames.length)try{$(h,v.transaction(Pe(v.objectStoreNames),O))}catch(t){}v.onversionchange=Kt(function(t){S._vcFired=!0,S.on("versionchange").fire(t)}),A||"__dbnames"===o||ce.dbnames.put({name:o}).catch(St),t()},r)})]).then(function(){return w=[],Dt.resolve(we.vip(S.on.ready.fire)).then(function t(){if(0<w.length){var e=w.reduce(Pt,St);return w=[],Dt.resolve(we.vip(e)).then(t)}})}).finally(function(){w=null}).then(function(){return m=!1,S}).catch(function(t){try{i&&i.abort()}catch(t){}return m=!1,S.close(),ue(y=t)}).finally(function(){_=!0,t()})},this.close=function(){var t=be.indexOf(S);if(0<=t&&be.splice(t,1),v){try{v.close()}catch(t){}v=null}c=!1,y=new xt.DatabaseClosed,m&&r(y),E=new Dt(function(t){e=t}),j=new Dt(function(t,e){r=e})},this.delete=function(){var n=0<arguments.length;return new Dt(function(e,r){if(n)throw new xt.InvalidArgument("Arguments not allowed in db.delete()");function t(){S.close();var t=l.deleteDatabase(o);t.onsuccess=Kt(function(){A||ce.dbnames.delete(o).catch(St),e()}),t.onerror=xe(r),t.onblocked=J}m?E.then(t):t()})},this.backendDB=function(){return v},this.isOpen=function(){return null!==v},this.hasBeenClosed=function(){return y&&y instanceof xt.DatabaseClosed},this.hasFailed=function(){return null!==y},this.dynamicallyOpened=function(){return k},this.name=o,rt(this,{tables:{get:function(){return G(b).map(function(t){return b[t]})}}}),this.on=ae(this,"populate","blocked","versionchange",{ready:[Pt,St]}),this.on.ready.subscribe=ot(this.on.ready.subscribe,function(r){return function(e,t){we.vip(function(){_?(y||Dt.resolve().then(e),t&&r(e)):w?(w.push(e),t&&r(e)):(r(e),t||r(function t(){S.on.ready.unsubscribe(e),S.on.ready.unsubscribe(t)}))})}}),this.transaction=function(){var t=function(t,e,r){var n=arguments.length;if(n<2)throw new xt.InvalidArgument("Too few arguments");var i=new Array(n-1);for(;--n;)i[n-1]=arguments[n];r=i.pop();var o=pt(i);return[t,o,r]}.apply(this,arguments);return this._transaction.apply(this,t)},this._transaction=function(o,t,s){var u=Rt.trans;u&&u.db===S&&-1===o.indexOf("!")||(u=null);var e=-1!==o.indexOf("?");o=o.replace("!","").replace("?","");try{var a=t.map(function(t){var e=t instanceof R?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e});if("r"==o||o==O)o=O;else{if("rw"!=o&&o!=x)throw new xt.InvalidArgument("Invalid transaction mode: "+o);o=x}if(u){if(u.mode===O&&o===x){if(!e)throw new xt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u=null}u&&a.forEach(function(t){if(u&&-1===u.storeNames.indexOf(t)){if(!e)throw new xt.SubTransaction("Table "+t+" not included in parent transaction.");u=null}}),e&&u&&!u.active&&(u=null)}}catch(r){return u?u._promise(null,function(t,e){e(r)}):ue(r)}return u?u._promise(o,r,"lock"):Rt.trans?re(Rt.transless,function(){return S._whenReady(r)}):S._whenReady(r);function r(){return Dt.resolve().then(function(){var e,t=Rt.transless||Rt,r=S._createTransaction(o,a,h,u),n={trans:r,transless:t};u?r.idbtrans=u.idbtrans:r.create(),s.constructor===Mt&&Jt();var i=Dt.follow(function(){if(e=s.call(r,r))if(e.constructor===It){var t=Gt.bind(null,null);e.then(t,t)}else"function"==typeof e.next&&"function"==typeof e.throw&&(e=ke(e))},n);return(e&&"function"==typeof e.then?Dt.resolve(e).then(function(t){return r.active?t:ue(new xt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):i.then(function(){return e})).then(function(t){return u&&r._resolve(),r._completion.then(function(){return t})}).catch(function(t){return r._reject(t),ue(t)})})}},this.table=function(t){if(!et(b,t))throw new xt.InvalidTable("Table "+t+" does not exist");return b[t]},rt(R.prototype,{_trans:function(t,e,r){var n=this._tx||Rt.trans;return n&&n.db===S?n===Rt.trans?n._promise(t,e,r):$t(function(){return n._promise(t,e,r)},{trans:n,transless:Rt.transless||Rt}):function t(e,r,n){if(_||Rt.letThrough){var i=S._createTransaction(e,r,h);try{i.create()}catch(t){return ue(t)}return i._promise(e,function(t,e){return $t(function(){return Rt.trans=i,n(t,e,i)})}).then(function(t){return i._completion.then(function(){return t})})}if(!m){if(!c)return ue(new xt.DatabaseClosed);S.open().catch(St)}return E.then(function(){return t(e,r,n)})}(t,[this.name],e)},_idbstore:function(t,n,e){var i=this.name;return this._trans(t,function(t,e,r){if(-1===r.storeNames.indexOf(i))throw new xt.NotFound("Table"+i+" not part of transaction");return n(t,e,r.idbtrans.objectStore(i),r)},e)},get:function(i,t){if(i&&i.constructor===Object)return this.where(i).first(t);var o=this;return this._idbstore(O,function(t,e,r){var n=r.get(i);n.onerror=xe(e),n.onsuccess=Kt(function(){t(o.hook.reading.fire(n.result))},e)}).then(t)},where:function(r){if("string"==typeof r)return new C(this,r);if(Q(r))return new C(this,"["+r.join("+")+"]");var n=G(r);if(1===n.length)return this.where(n[0]).equals(r[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter(function(e){return e.compound&&n.every(function(t){return 0<=e.keyPath.indexOf(t)})&&e.keyPath.every(function(t){return 0<=n.indexOf(t)})})[0];if(t&&fe!==le)return this.where(t.name).equals(t.keyPath.map(function(t){return r[t]}));t||console.warn("The query "+JSON.stringify(r)+" on "+this.name+" would benefit of a compound index ["+n.join("+")+"]");var i=this.schema.idxByName,e=n.reduce(function(t,e){return[t[0]||i[e],t[0]||!i[e]?Y(t[1],function(t){return""+lt(t,e)==""+r[e]}):t[1]]},[null,null]),o=e[0];return o?this.where(o.name).equals(r[o.keyPath]).filter(e[1]):t?this.filter(e[1]):this.where(n).equals("")},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){return this.toCollection().each(t)},toArray:function(t){return this.toCollection().toArray(t)},orderBy:function(t){return new L(new C(this,Q(t)?"["+t.join("+")+"]":t))},toCollection:function(){return new L(new C(this))},mapToClass:function(n,t){this.schema.mappedClass=n;var e=Object.create(n.prototype);t&&_e(e,t),this.schema.instanceTemplate=e;var r=function(t){if(!t)return t;var e=Object.create(n.prototype);for(var r in t)if(et(t,r))try{e[r]=t[r]}catch(t){}return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),n},defineClass:function(t){return this.mapToClass(we.defineClass(t),t)},bulkDelete:function(i){return this.hook.deleting.fire===St?this._idbstore(x,function(t,e,r,n){t(N(r,n,i,!1,St))}):this.where(":id").anyOf(i).delete().then(function(){})},bulkPut:function(p,d){var b=this;return this._idbstore(x,function(e,r,n){if(!n.keyPath&&!b.schema.primKey.auto&&!d)throw new xt.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(n.keyPath&&d)throw new xt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==p.length)throw new xt.InvalidArgument("Arguments objects and keys must have the same length");if(0===p.length)return e();var t,i,o=function(t){0===s.length?e(t):r(new Ot(b.name+".bulkPut(): "+s.length+" of "+u+" operations failed",s))},s=[],u=p.length,a=b;if(b.hook.creating.fire===St&&b.hook.updating.fire===St){i=D(s);for(var c=0,l=p.length;c<l;++c)(t=d?n.put(p[c],d[c]):n.put(p[c])).onerror=i;t.onerror=D(s,o),t.onsuccess=Se(o)}else{var f=d||n.keyPath&&p.map(function(t){return lt(t,n.keyPath)}),h=f&&ut(f,function(t,e){return null!=t&&[t,p[e]]});(f?a.where(":id").anyOf(f.filter(function(t){return null!=t})).modify(function(){this.value=h[this.primKey],h[this.primKey]=null}).catch(_t,function(t){s=t.failures}).then(function(){for(var t=[],e=d&&[],r=f.length-1;0<=r;--r){var n=f[r];(null==n||h[n])&&(t.push(p[r]),d&&e.push(n),null!=n&&(h[n]=null))}return t.reverse(),d&&e.reverse(),a.bulkAdd(t,e)}).then(function(t){var e=f[f.length-1];return null!=e?e:t}):a.bulkAdd(p)).then(o).catch(Ot,function(t){s=s.concat(t.failures),o()}).catch(r)}},"locked")},bulkAdd:function(d,b){var v=this,y=this.hook.creating.fire;return this._idbstore(x,function(e,r,s,u){if(!s.keyPath&&!v.schema.primKey.auto&&!b)throw new xt.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(s.keyPath&&b)throw new xt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(b&&b.length!==d.length)throw new xt.InvalidArgument("Arguments objects and keys must have the same length");if(0===d.length)return e();function t(t){0===n.length?e(t):r(new Ot(v.name+".bulkAdd(): "+n.length+" of "+i+" operations failed",n))}var a,c,l,n=[],i=d.length;if(y!==St){var f,h=s.keyPath;c=D(n,null,!0),l=Oe(null),ct(function(){for(var t=0,e=d.length;t<e;++t){f={onerror:null,onsuccess:null};var r=b&&b[t],n=d[t],i=b?r:h?lt(n,h):void 0,o=y.call(f,i,n,u);null==i&&null!=o&&(h?ft(n=dt(n),h,o):r=o),(a=null!=r?s.add(n,r):s.add(n))._hookCtx=f,t<e-1&&(a.onerror=c,f.onsuccess&&(a.onsuccess=l))}},function(t){throw f.onerror&&f.onerror(t),t}),a.onerror=D(n,t,!0),a.onsuccess=Oe(t)}else{c=D(n);for(var o=0,p=d.length;o<p;++o)(a=b?s.add(d[o],b[o]):s.add(d[o])).onerror=c;a.onerror=D(n,t),a.onsuccess=Se(t)}})},add:function(a,c){var l=this.hook.creating.fire;return this._idbstore(x,function(r,t,n,e){var i={onsuccess:null,onerror:null};if(l!==St){var o=null!=c?c:n.keyPath?lt(a,n.keyPath):void 0,s=l.call(i,o,a,e);null==o&&null!=s&&(n.keyPath?ft(a,n.keyPath,s):c=s)}try{var u=null!=c?n.add(a,c):n.add(a);u._hookCtx=i,u.onerror=Ee(t),u.onsuccess=Oe(function(t){var e=n.keyPath;e&&ft(a,e,t),r(t)})}catch(t){throw i.onerror&&i.onerror(t),t}})},put:function(o,e){var r=this,t=this.hook.creating.fire,n=this.hook.updating.fire;if(t!==St||n!==St){var i=this.schema.primKey.keyPath,s=void 0!==e?e:i&&lt(o,i);return null==s?this.add(o):(o=dt(o),this._trans(x,function(){return r.where(":id").equals(s).modify(function(){this.value=o}).then(function(t){return 0===t?r.add(o,e):s})},"locked"))}return this._idbstore(x,function(r,t,n){var i=void 0!==e?n.put(o,e):n.put(o);i.onerror=xe(t),i.onsuccess=Kt(function(t){var e=n.keyPath;e&&ft(o,e,t.target.result),r(i.result)})})},delete:function(i){return this.hook.deleting.subscribers.length?this.where(":id").equals(i).delete():this._idbstore(x,function(t,e,r){var n=r.delete(i);n.onerror=xe(e),n.onsuccess=Kt(function(){t(n.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(x,function(t,e,r){var n=r.clear();n.onerror=xe(e),n.onsuccess=Kt(function(){t(n.result)})})},update:function(e,r){if("object"!==(void 0===r?"undefined":Re(r))||Q(r))throw new xt.InvalidArgument("Modifications must be an object.");if("object"!==(void 0===e?"undefined":Re(e))||Q(e))return this.where(":id").equals(e).modify(r);G(r).forEach(function(t){ft(e,t,r[t])});var t=lt(e,this.schema.primKey.keyPath);return void 0===t?ue(new xt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(r)}}),rt(B.prototype,{_lock:function(){return st(!Rt.global),++this._reculock,1!==this._reculock||Rt.global||(Rt.lockOwnerFor=this),this},_unlock:function(){if(st(!Rt.global),0==--this._reculock)for(Rt.global||(Rt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var t=this._blockedFuncs.shift();try{re(t[1],t[0])}catch(t){}}return this},_locked:function(){return this._reculock&&Rt.lockOwnerFor!==this},create:function(e){var r=this;if(!this.mode)return this;if(st(!this.idbtrans),!e&&!v)switch(y&&y.name){case"DatabaseClosedError":throw new xt.DatabaseClosed(y);case"MissingAPIError":throw new xt.MissingAPI(y.message,y);default:throw new xt.OpenFailed(y)}if(!this.active)throw new xt.TransactionInactive;return st(null===this._completion._state),(e=this.idbtrans=e||v.transaction(Pe(this.storeNames),this.mode)).onerror=Kt(function(t){je(t),r._reject(e.error)}),e.onabort=Kt(function(t){je(t),r.active&&r._reject(new xt.Abort(e.error)),r.active=!1,r.on("abort").fire(t)}),e.oncomplete=Kt(function(){r.active=!1,r._resolve()}),this},_promise:function(r,n,i){var o=this;if(r===x&&this.mode!==x)return ue(new xt.ReadOnly("Transaction is readonly"));if(!this.active)return ue(new xt.TransactionInactive);if(this._locked())return new Dt(function(t,e){o._blockedFuncs.push([function(){o._promise(r,n,i).then(t,e)},Rt])});if(i)return $t(function(){var t=new Dt(function(t,e){o._lock();var r=n(t,e,o);r&&r.then&&r.then(t,e)});return t.finally(function(){return o._unlock()}),t._lib=!0,t});var t=new Dt(function(t,e){var r=n(t,e,o);r&&r.then&&r.then(t,e)});return t._lib=!0,t},_root:function(){return this.parent?this.parent._root():this},waitFor:function(t){var n=this._root();if(t=Dt.resolve(t),n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return t});else{n._waitingFor=t,n._waitingQueue=[];var e=n.idbtrans.objectStore(n.storeNames[0]);!function t(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(e.get(-1/0).onsuccess=t)}()}var i=n._waitingFor;return new Dt(function(e,r){t.then(function(t){return n._waitingQueue.push(Kt(e.bind(null,t)))},function(t){return n._waitingQueue.push(Kt(r.bind(null,t)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},abort:function(){this.active&&this._reject(new xt.Abort),this.active=!1},tables:{get:(n="Transaction.tables",i=function(){return b},function(){return console.warn(n+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+wt(gt(),1)),i.apply(this,arguments)})},table:function(t){var e=S.table(t);return new R(t,e.schema,this)}}),rt(C.prototype,function(){function y(t,e,r){var n=t instanceof C?new L(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function h(t){return new L(t,function(){return g.only("")}).limit(0)}function m(t,e,r,n,i,o){for(var s=Math.min(t.length,n.length),u=-1,a=0;a<s;++a){var c=e[a];if(c!==n[a])return i(t[a],r[a])<0?t.substr(0,a)+r[a]+r.substr(a+1):i(t[a],n[a])<0?t.substr(0,a)+n[a]+r.substr(a+1):0<=u?t.substr(0,u)+e[u]+r.substr(u+1):null;i(t[a],c)<0&&(u=a)}return s<n.length&&"next"===o?t+r.substr(t.length):s<t.length&&"prev"===o?t.substr(0,r.length):u<0?null:t.substr(0,u)+n[u]+r.substr(u+1)}function e(t,a,r,n){var i,c,l,f,h,p,d,b=r.length;if(!r.every(function(t){return"string"==typeof t}))return y(t,de);function e(t){i="next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()},c="next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()},l="next"===t?z:X;var e=r.map(function(t){return{lower:c(t),upper:i(t)}}).sort(function(t,e){return l(t.lower,e.lower)});f=e.map(function(t){return t.upper}),h=e.map(function(t){return t.lower}),d="next"===(p=t)?"":n}e("next");var o=new L(t,function(){return g.bound(f[0],h[b-1]+n)});o._ondirectionchange=function(t){e(t)};var v=0;return o._addAlgorithm(function(t,e,r){var n=t.key;if("string"!=typeof n)return!1;var i=c(n);if(a(i,h,v))return!0;for(var o=null,s=v;s<b;++s){var u=m(n,i,f[s],h[s],l,p);null===u&&null===o?v=s+1:(null===o||0<l(o,u))&&(o=u)}return e(null!==o?function(){t.continue(o+d)}:r),!1}),o}return{between:function(t,e,r,n){r=!1!==r,n=!0===n;try{return 0<U(t,e)||0===U(t,e)&&(r||n)&&(!r||!n)?h(this):new L(this,function(){return g.bound(t,e,!r,!n)})}catch(t){return y(this,pe)}},equals:function(t){return new L(this,function(){return g.only(t)})},above:function(t){return new L(this,function(){return g.lowerBound(t,!0)})},aboveOrEqual:function(t){return new L(this,function(){return g.lowerBound(t)})},below:function(t){return new L(this,function(){return g.upperBound(t,!0)})},belowOrEqual:function(t){return new L(this,function(){return g.upperBound(t)})},startsWith:function(t){return"string"!=typeof t?y(this,de):this.between(t,t+le,!0,!0)},startsWithIgnoreCase:function(t){return""===t?this.startsWith(t):e(this,function(t,e){return 0===t.indexOf(e[0])},[t],le)},equalsIgnoreCase:function(t){return e(this,function(t,e){return t===e[0]},[t],"")},anyOfIgnoreCase:function(){var t=yt.apply(vt,arguments);return 0===t.length?h(this):e(this,function(t,e){return-1!==e.indexOf(t)},t,"")},startsWithAnyOfIgnoreCase:function(){var t=yt.apply(vt,arguments);return 0===t.length?h(this):e(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},t,le)},anyOf:function(){var i=yt.apply(vt,arguments),o=W;try{i.sort(o)}catch(t){return y(this,pe)}if(0===i.length)return h(this);var t=new L(this,function(){return g.bound(i[0],i[i.length-1])});t._ondirectionchange=function(t){o="next"===t?W:V,i.sort(o)};var s=0;return t._addAlgorithm(function(t,e,r){for(var n=t.key;0<o(n,i[s]);)if(++s===i.length)return e(r),!1;return 0===o(n,i[s])||(e(function(){t.continue(i[s])}),!1)}),t},notEqual:function(t){return this.inAnyRange([[he,t],[t,fe]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=yt.apply(vt,arguments);if(0===t.length)return new L(this);try{t.sort(W)}catch(t){return y(this,pe)}var e=t.reduce(function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[he,e]]},null);return e.push([t[t.length-1],fe]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(t,e){if(0===t.length)return h(this);if(!t.every(function(t){return void 0!==t[0]&&void 0!==t[1]&&W(t[0],t[1])<=0}))return y(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",xt.InvalidArgument);var r=!e||!1!==e.includeLowers,n=e&&!0===e.includeUppers;var o,s=W;function i(t,e){return s(t[0],e[0])}try{(o=t.reduce(function(t,e){for(var r=0,n=t.length;r<n;++r){var i=t[r];if(U(e[0],i[1])<0&&0<U(e[1],i[0])){i[0]=(u=i[0],a=e[0],U(u,a)<0?u:a),i[1]=(o=i[1],s=e[1],0<U(o,s)?o:s);break}}var o,s,u,a;return r===n&&t.push(e),t},[])).sort(i)}catch(t){return y(this,pe)}var u=0,a=n?function(t){return 0<W(t,o[u][1])}:function(t){return 0<=W(t,o[u][1])},c=r?function(t){return 0<V(t,o[u][0])}:function(t){return 0<=V(t,o[u][0])};var l=a,f=new L(this,function(){return g.bound(o[0][0],o[o.length-1][1],!r,!n)});return f._ondirectionchange=function(t){"next"===t?(l=a,s=W):(l=c,s=V),o.sort(i)},f._addAlgorithm(function(t,e,r){for(var n,i=t.key;l(i);)if(++u===o.length)return e(r),!1;return!a(n=i)&&!c(n)||(0===U(i,o[u][1])||0===U(i,o[u][0])||e(function(){s===W?t.continue(o[u][0]):t.continue(o[u][1])}),!1)}),f},startsWithAnyOf:function(){var t=yt.apply(vt,arguments);return t.every(function(t){return"string"==typeof t})?0===t.length?h(this):this.inAnyRange(t.map(function(t){return[t,t+le]})):y(this,"startsWithAnyOf() only works with strings")}}}),rt(L.prototype,function(){function o(t,e){t.filter=Y(t.filter,e)}function r(t,e,r){var n=t.replayFilter;t.replayFilter=n?function(){return Y(n(),e())}:e,t.justLimit=r&&!n}function a(t,e){if(t.isPrimKey)return e;var r=t.table.schema.idxByName[t.index];if(!r)throw new xt.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return e.index(r.name)}function l(t,e){var r=a(t,e);return t.keysOnly&&"openKeyCursor"in r?r.openKeyCursor(t.range||null,t.dir+t.unique):r.openCursor(t.range||null,t.dir+t.unique)}function c(r,u,n,a,i){var c=r.replayFilter?Y(r.filter,r.replayFilter()):r.filter;r.or?function(){var o={},t=0;function s(){2==++t&&n()}function e(t,e,r){if(!c||c(e,r,s,a)){var n=e.primaryKey,i=""+n;"[object ArrayBuffer]"===i&&(i=""+new Uint8Array(n)),et(o,i)||(o[i]=!0,u(t,e,r))}}r.or._iterate(e,s,a,i),K(l(r,i),r.algorithm,e,s,a,!r.keysOnly&&r.valueMapper)}():K(l(r,i),Y(r.algorithm,c),u,n,a,!r.keysOnly&&r.valueMapper)}return{_read:function(t,e){var r=this._ctx;return r.error?r.table._trans(null,ue.bind(null,r.error)):r.table._idbstore(O,t).then(e)},_write:function(t){var e=this._ctx;return e.error?e.table._trans(null,ue.bind(null,e.error)):e.table._idbstore(x,t,"locked")},_addAlgorithm:function(t){var e=this._ctx;e.algorithm=Y(e.algorithm,t)},_iterate:function(t,e,r,n){return c(this._ctx,t,e,r,n)},clone:function(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&tt(r,t),e._ctx=r,e},raw:function(){return this._ctx.valueMapper=null,this},each:function(n){var i=this._ctx;return this._read(function(t,e,r){c(i,n,t,e,r)})},count:function(t){var o=this._ctx;if(F(o,!0))return this._read(function(e,t,r){var n=a(o,r),i=o.range?n.count(o.range):n.count();i.onerror=xe(t),i.onsuccess=function(t){e(Math.min(t.target.result,o.limit))}},t);var n=0;return this._read(function(t,e,r){c(o,function(){return++n,!1},function(){t(n)},e,r)},t)},sortBy:function(t,e){var r=t.split(".").reverse(),n=r[0],i=r.length-1;function o(t,e){return e?o(t[r[e]],e-1):t[n]}var s="next"===this._ctx.dir?1:-1;function u(t,e){var r=o(t,i),n=o(e,i);return r<n?-s:n<r?s:0}return this.toArray(function(t){return t.sort(u)}).then(e)},toArray:function(t){var u=this._ctx;return this._read(function(e,r,t){if(f&&"next"===u.dir&&F(u,!0)&&0<u.limit){var n=u.table.hook.reading.fire,i=a(u,t),o=u.limit<1/0?i.getAll(u.range,u.limit):i.getAll(u.range);o.onerror=xe(r),o.onsuccess=Se(n===Et?e:function(t){try{e(t.map(n))}catch(t){r(t)}})}else{var s=[];c(u,function(t){s.push(t)},function(){e(s)},r,t)}},t)},offset:function(e){var t=this._ctx;return e<=0||(t.offset+=e,F(t)?r(t,function(){var r=e;return function(t,e){return 0===r||(1===r?--r:e(function(){t.advance(r),r=0}),!1)}}):r(t,function(){var t=e;return function(){return--t<0}})),this},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),r(this._ctx,function(){var n=t;return function(t,e,r){return--n<=0&&e(r),0<=n}},!0),this},until:function(n,i){return o(this._ctx,function(t,e,r){return!n(t.value)||(e(r),i)}),this},first:function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},last:function(t){return this.reverse().first(t)},filter:function(e){var t,r;return o(this._ctx,function(t){return e(t.value)}),t=this._ctx,r=e,t.isMatch=Y(t.isMatch,r),this},and:function(t){return this.filter(t)},or:function(t){return new C(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(r){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,e){r(e.key,e)})},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},eachPrimaryKey:function(r){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,e){r(e.primaryKey,e)})},keys:function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var r=[];return this.each(function(t,e){r.push(e.key)}).then(function(){return r}).then(t)},primaryKeys:function(t){var o=this._ctx;if(f&&"next"===o.dir&&F(o,!0)&&0<o.limit)return this._read(function(t,e,r){var n=a(o,r),i=o.limit<1/0?n.getAllKeys(o.range,o.limit):n.getAllKeys(o.range);i.onerror=xe(e),i.onsuccess=Se(t)}).then(t);o.keysOnly=!o.isMatch;var r=[];return this.each(function(t,e){r.push(e.primaryKey)}).then(function(){return r}).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var n={};return o(this._ctx,function(t){var e=t.primaryKey.toString(),r=et(n,e);return n[e]=!0,!r}),this},modify:function(v){var y=this,t=this._ctx.table.hook,m=t.updating.fire,g=t.deleting.fire;return this._write(function(t,e,r,i){var o;if("function"==typeof v)o=m===St&&g===St?v:function(e){var t=dt(e);if(!1===v.call(this,e,this))return!1;if(et(this,"value")){var r=bt(t,this.value),n=m.call(this,r,this.primKey,t,i);n&&(e=this.value,G(n).forEach(function(t){ft(e,t,n[t])}))}else g.call(this,this.primKey,e,i)};else if(m===St){var s=G(v),u=s.length;o=function(t){for(var e=!1,r=0;r<u;++r){var n=s[r],i=v[n];lt(t,n)!==i&&(ft(t,n,i),e=!0)}return e}}else{var a=v;v=ht(a),o=function(r){var n=!1,t=m.call(this,v,this.primKey,dt(r),i);return t&&tt(v,t),G(v).forEach(function(t){var e=v[t];lt(r,t)!==e&&(ft(r,t,e),n=!0)}),t&&(v=ht(a)),n}}var c=0,l=0,n=!1,f=[],h=[],p=null;function d(t){return t&&(f.push(t),h.push(p)),e(new _t("Error modifying one or more objects",f,l,h))}function b(){n&&l+f.length===c&&(0<f.length?d():t(l))}y.clone().raw()._iterate(function(t,e){p=e.primaryKey;var r={primKey:e.primaryKey,value:t,onsuccess:null,onerror:null};function n(t){return f.push(t),h.push(r.primKey),b(),!0}if(!1!==o.call(r,t,r)){var i=!et(r,"value");++c,ct(function(){var t=i?e.delete():e.update(r.value);t._hookCtx=r,t.onerror=Ee(n),t.onsuccess=Oe(function(){++l,b()})},n)}else r.onsuccess&&r.onsuccess(r.value)},function(){n=!0,b()},d,r)})},delete:function(){var u=this,a=this._ctx,s=a.range,c=a.table.hook.deleting.fire,l=c!==St;if(!l&&F(a)&&(a.isPrimKey&&!me||!s))return this._write(function(r,n,i){var o=xe(n),t=s?i.count(s):i.count();t.onerror=o,t.onsuccess=function(){var e=t.result;ct(function(){var t=s?i.delete(s):i.clear();t.onerror=o,t.onsuccess=function(){return r(e)}},function(t){return n(t)})}});var f=l?2e3:1e4;return this._write(function(t,e,r,n){var i=0,o=u.clone({keysOnly:!a.isMatch&&!l}).distinct().limit(f).raw(),s=[];t(function e(){return o.each(l?function(t,e){s.push([e.primaryKey,e.value])}:function(t,e){s.push(e.primaryKey)}).then(function(){return l?s.sort(function(t,e){return W(t[0],e[0])}):s.sort(W),N(r,n,s,l,c)}).then(function(){var t=s.length;return i+=t,s=[],t<f?i:e()})}())})}}}),tt(this,{Collection:L,Table:R,Transaction:B,Version:T,WhereClause:C}),S.on("versionchange",function(t){0<t.newVersion?console.warn("Another connection wants to upgrade database '"+S.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+S.name+"'. Closing db now to resume the delete request."),S.close()}),S.on("blocked",function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+S.name+"') was blocked"):console.warn("Upgrade '"+S.name+"' blocked by other connection holding version "+t.oldVersion/10)}),a.forEach(function(t){t(S)})}function _e(r,n){return G(n).forEach(function(t){var e=function t(e){if("function"==typeof e)return new e;if(Q(e))return[t(e[0])];if(e&&"object"===(void 0===e?"undefined":Re(e))){var r={};return _e(r,e),r}return e}(n[t]);r[t]=e}),r}function Oe(o){return Kt(function(t){var e=t.target,r=e._hookCtx,n=r.value||e.result,i=r&&r.onsuccess;i&&i(n),o&&o(n)},o)}function xe(e){return Kt(function(t){return je(t),e(t.target.error),!1})}function Se(e){return Kt(function(t){e(t.target.result)})}function Ee(o){return Kt(function(t){var e=t.target,r=e.error,n=e._hookCtx,i=n&&n.onerror;return i&&i(r),je(t),o(r),!1})}function je(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function ke(e){var t=function(t){return e.next(t)},i=r(t),o=r(function(t){return e.throw(t)});function r(n){return function(t){var e=n(t),r=e.value;return e.done?r:r&&"function"==typeof r.then?r.then(i,o):Q(r)?Dt.all(r).then(i,o):i(r)}}return r(t)()}function Ae(t,e,r,n,i,o,s){this.name=t,this.keyPath=e,this.unique=r,this.multi=n,this.auto=i,this.compound=o,this.dotted=s;var u="string"==typeof e?e:e&&"["+[].join.call(e,"+")+"]";this.src=(r?"&":"")+(n?"*":"")+(i?"++":"")+u}function Te(t,e,r,n){this.name=t,this.primKey=e||new Ae,this.indexes=r||[new Ae],this.instanceTemplate=n,this.mappedClass=null,this.idxByName=ut(r,function(t){return[t.name,t]})}function Pe(t){return 1===t.length?t[0]:t}function Ie(t){var e=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return e&&e.bind(t)}return h(mt,ge),rt(we,_),rt(we,{delete:function(t){var e=new we(t),r=e.delete();return r.onblocked=function(t){return e.on("blocked",t),this},r},exists:function(t){return new we(t).open().then(function(t){return t.close(),!0}).catch(we.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(t){var n=Ie(we.dependencies.indexedDB);return n?new Dt(function(e,t){var r=n();r.onsuccess=function(t){e(it(t.target.result,0))},r.onerror=xe(t)}).then(t):ce.dbnames.toCollection().primaryKeys(t)},defineClass:function(){return function(t){t&&tt(this,t)}},applyStructure:_e,ignoreTransaction:function(t){return Rt.trans?re(Rt.transless,t):t()},vip:function(t){return $t(function(){return Rt.letThrough=!0,t()})},async:function(e){return function(){try{var t=ke(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Dt.resolve(t)}catch(t){return ue(t)}}},spawn:function(t,e,r){try{var n=ke(t.apply(r,e||[]));return n&&"function"==typeof n.then?n:Dt.resolve(n)}catch(t){return ue(t)}},currentTransaction:{get:function(){return Rt.trans||null}},waitFor:function(t,e){var r=Dt.resolve("function"==typeof t?we.ignoreTransaction(t):t).timeout(e||6e4);return Rt.trans?Rt.trans.waitFor(r):r},Promise:Dt,debug:{get:function(){return mt},set:function(t){h(t,"dexie"===t?function(){return!0}:ge)}},derive:s,extend:tt,props:rt,override:ot,Events:ae,getByKeyPath:lt,setByKeyPath:ft,delByKeyPath:function(e,t){"string"==typeof t?ft(e,t,void 0):"length"in t&&[].map.call(t,function(t){ft(e,t,void 0)})},shallowClone:ht,deepClone:dt,getObjectDiff:bt,asap:a,maxKey:fe,minKey:he,addons:[],connections:be,MultiModifyError:xt.Modify,errnames:m,IndexSpec:Ae,TableSchema:Te,dependencies:function(){try{return{indexedDB:Z.indexedDB||Z.mozIndexedDB||Z.webkitIndexedDB||Z.msIndexedDB,IDBKeyRange:Z.IDBKeyRange||Z.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"2.0.4",version:"2.0.4".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,r){return t+e/Math.pow(10,2*r)}),default:we,Dexie:we}),Dt.rejectionMapper=function(t,e){if(!t||t instanceof y||t instanceof TypeError||t instanceof SyntaxError||!t.name||!w[t.name])return t;var r=new w[t.name](e||t.message,t);return"stack"in t&&nt(r,"stack",{get:function(){return this.inner.stack}}),r},(ce=new we("__dbnames")).version(1).stores({dbnames:"name"}),function(){var t="Dexie.DatabaseNames";try{void 0!==("undefined"==typeof localStorage?"undefined":Re(localStorage))&&void 0!==Z.document&&(JSON.parse(localStorage.getItem(t)||"[]").forEach(function(t){return ce.dbnames.put({name:t}).catch(St)}),localStorage.removeItem(t))}catch(t){}}(),we},"object"===((t=void 0)===n?"undefined":Re(n))&&void 0!==r?r.exports=e():"function"==typeof define&&define.amd?define(e):t.Dexie=e()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=function(n){function t(t,e,r){n.call(this),this.parent=t,this.outerValue=e,this.outerIndex=r,this.index=0}return i(t,n),t.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},t.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(t("./Subscriber").Subscriber);r.InnerSubscriber=n},{"./Subscriber":9}],3:[function(t,e,r){"use strict";var n=t("./Observable"),i=function(){function e(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return e.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},e.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},e.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},e.prototype.toObservable=function(){switch(this.kind){case"N":return n.Observable.of(this.value);case"E":return n.Observable.throw(this.error);case"C":return n.Observable.empty()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();r.Notification=i},{"./Observable":4}],4:[function(t,e,r){"use strict";var o=t("./util/root"),s=t("./util/toSubscriber"),n=t("./symbol/observable"),i=t("./util/pipe"),u=function(){function r(t){this._isScalar=!1,t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,r){var n=this.operator,i=s.toSubscriber(t,e,r);if(n?n.call(i,this.source):i.add(this.source||!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},r.prototype.forEach=function(n,t){var i=this;if(t||(o.root.Rx&&o.root.Rx.config&&o.root.Rx.config.Promise?t=o.root.Rx.config.Promise:o.root.Promise&&(t=o.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,e){var r;r=i.subscribe(function(t){if(r)try{n(t)}catch(t){e(t),r.unsubscribe()}else n(t)},e,t)})},r.prototype._subscribe=function(t){return this.source.subscribe(t)},r.prototype[n.observable]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:i.pipeFromArray(t)(this)},r.prototype.toPromise=function(t){var n=this;if(t||(o.root.Rx&&o.root.Rx.config&&o.root.Rx.config.Promise?t=o.root.Rx.config.Promise:o.root.Promise&&(t=o.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,e){var r;n.subscribe(function(t){return r=t},function(t){return e(t)},function(){return t(r)})})},r.create=function(t){return new r(t)},r}();r.Observable=u},{"./symbol/observable":49,"./util/pipe":62,"./util/root":63,"./util/toSubscriber":65}],5:[function(t,e,r){"use strict";r.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},{}],6:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){t.apply(this,arguments)}return n(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(t("./Subscriber").Subscriber);r.OuterSubscriber=i},{"./Subscriber":9}],7:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=t("./Observable"),o=t("./Subscriber"),s=t("./Subscription"),u=t("./util/ObjectUnsubscribedError"),a=t("./SubjectSubscription"),c=t("./symbol/rxSubscriber"),l=function(e){function t(t){e.call(this,t),this.destination=t}return n(t,e),t}(o.Subscriber);r.SubjectSubscriber=l;var f=function(e){function t(){e.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return n(t,e),t.prototype[c.rxSubscriber]=function(){return new l(this)},t.prototype.lift=function(t){var e=new h(this,this);return e.operator=t,e},t.prototype.next=function(t){if(this.closed)throw new u.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},t.prototype.error=function(t){if(this.closed)throw new u.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new u.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new u.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(t){if(this.closed)throw new u.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),s.Subscription.EMPTY):this.isStopped?(t.complete(),s.Subscription.EMPTY):(this.observers.push(t),new a.SubjectSubscription(this,t))},t.prototype.asObservable=function(){var t=new i.Observable;return t.source=this,t},t.create=function(t,e){return new h(t,e)},t}(i.Observable),h=function(r){function t(t,e){r.call(this),this.destination=t,this.source=e}return n(t,r),t.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},t.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},t.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},t.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.Subscription.EMPTY},t}(r.Subject=f);r.AnonymousSubject=h},{"./Observable":4,"./SubjectSubscription":8,"./Subscriber":9,"./Subscription":10,"./symbol/rxSubscriber":50,"./util/ObjectUnsubscribedError":51}],8:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(r){function t(t,e){r.call(this),this.subject=t,this.subscriber=e,this.closed=!1}return n(t,r),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},t}(t("./Subscription").Subscription);r.SubjectSubscription=i},{"./Subscription":10}],9:[function(t,e,r){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=t("./util/isFunction"),i=t("./Subscription"),a=t("./Observer"),c=t("./symbol/rxSubscriber"),l=function(o){function i(t,e,r){switch(o.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!t){this.destination=a.empty;break}if("object"===(void 0===t?"undefined":s(t))){if((i=t)instanceof l||"syncErrorThrowable"in i&&i[c.rxSubscriber]){var n=t[c.rxSubscriber]();this.syncErrorThrowable=n.syncErrorThrowable,(this.destination=n).add(this)}else this.syncErrorThrowable=!0,this.destination=new f(this,t);break}default:this.syncErrorThrowable=!0,this.destination=new f(this,t,e,r)}var i}return n(i,o),i.prototype[c.rxSubscriber]=function(){return this},i.create=function(t,e,r){var n=new i(t,e,r);return n.syncErrorThrowable=!1,n},i.prototype.next=function(t){this.isStopped||this._next(t)},i.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},i.prototype._next=function(t){this.destination.next(t)},i.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},i.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},i.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},i}(i.Subscription),f=function(s){function t(t,e,r,n){var i;s.call(this),this._parentSubscriber=t;var o=this;u.isFunction(e)?i=e:e&&(i=e.next,r=e.error,n=e.complete,e!==a.empty&&(o=Object.create(e),u.isFunction(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=i,this._error=r,this._complete=n}return n(t,s),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};e.syncErrorThrowable?this.__tryOrSetError(e,r):this.__tryOrUnsub(r),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(r.Subscriber=l)},{"./Observer":5,"./Subscription":10,"./symbol/rxSubscriber":50,"./util/isFunction":57}],10:[function(t,e,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=t("./util/isArray"),f=t("./util/isObject"),h=t("./util/isFunction"),p=t("./util/tryCatch"),d=t("./util/errorObject"),b=t("./util/UnsubscriptionError"),n=function(){function n(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return n.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,u=n?n.length:0;r;)r.remove(this),r=++s<u&&n[s]||null;if(h.isFunction(i))p.tryCatch(i).call(this)===d.errorObject&&(e=!0,t=t||(d.errorObject.e instanceof b.UnsubscriptionError?v(d.errorObject.e.errors):[d.errorObject.e]));if(l.isArray(o))for(s=-1,u=o.length;++s<u;){var a=o[s];if(f.isObject(a))if(p.tryCatch(a.unsubscribe).call(a)===d.errorObject){e=!0,t=t||[];var c=d.errorObject.e;c instanceof b.UnsubscriptionError?t=t.concat(v(c.errors)):t.push(c)}}if(e)throw new b.UnsubscriptionError(t)}},n.prototype.add=function(t){if(!t||t===n.EMPTY)return n.EMPTY;if(t===this)return this;var e=t;switch(void 0===t?"undefined":i(t)){case"function":e=new n(t);case"object":if(e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if("function"!=typeof e._addParent){var r=e;(e=new n)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(e),e._addParent(this),e},n.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},n.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},n.EMPTY=((t=new n).closed=!0,t),n}();function v(t){return t.reduce(function(t,e){return t.concat(e instanceof b.UnsubscriptionError?e.errors:e)},[])}r.Subscription=n},{"./util/UnsubscriptionError":53,"./util/errorObject":54,"./util/isArray":55,"./util/isFunction":57,"./util/isObject":58,"./util/tryCatch":66}],11:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../observable/from");n.Observable.from=i.from},{"../../Observable":4,"../../observable/from":30}],12:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../observable/fromEvent");n.Observable.fromEvent=i.fromEvent},{"../../Observable":4,"../../observable/fromEvent":31}],13:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../observable/fromPromise");n.Observable.fromPromise=i.fromPromise},{"../../Observable":4,"../../observable/fromPromise":32}],14:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/catch");n.Observable.prototype.catch=i._catch,n.Observable.prototype._catch=i._catch},{"../../Observable":4,"../../operator/catch":33}],15:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/distinct");n.Observable.prototype.distinct=i.distinct},{"../../Observable":4,"../../operator/distinct":34}],16:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/filter");n.Observable.prototype.filter=i.filter},{"../../Observable":4,"../../operator/filter":35}],17:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/map");n.Observable.prototype.map=i.map},{"../../Observable":4,"../../operator/map":36}],18:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/mergeMap");n.Observable.prototype.mergeMap=i.mergeMap,n.Observable.prototype.flatMap=i.mergeMap},{"../../Observable":4,"../../operator/mergeMap":37}],19:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/retry");n.Observable.prototype.retry=i.retry},{"../../Observable":4,"../../operator/retry":38}],20:[function(t,e,r){"use strict";var n=t("../../Observable"),i=t("../../operator/retryWhen");n.Observable.prototype.retryWhen=i.retryWhen},{"../../Observable":4,"../../operator/retryWhen":39}],21:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=t("../Observable"),s=t("./ScalarObservable"),u=t("./EmptyObservable"),o=function(r){function o(t,e){r.call(this),this.arrayLike=t,(this.scheduler=e)||1!==t.length||(this._isScalar=!0,this.value=t[0])}return n(o,r),o.create=function(t,e){var r=t.length;return 0===r?new u.EmptyObservable:1===r?new s.ScalarObservable(t[0],e):new o(t,e)},o.dispatch=function(t){var e=t.arrayLike,r=t.index,n=t.length,i=t.subscriber;i.closed||(n<=r?i.complete():(i.next(e[r]),t.index=r+1,this.schedule(t)))},o.prototype._subscribe=function(t){var e=this.arrayLike,r=this.scheduler,n=e.length;if(r)return r.schedule(o.dispatch,0,{arrayLike:e,index:0,length:n,subscriber:t});for(var i=0;i<n&&!t.closed;i++)t.next(e[i]);t.complete()},o}(i.Observable);r.ArrayLikeObservable=o},{"../Observable":4,"./EmptyObservable":23,"./ScalarObservable":28}],22:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=t("../Observable"),s=t("./ScalarObservable"),u=t("./EmptyObservable"),a=t("../util/isScheduler"),o=function(r){function o(t,e){r.call(this),this.array=t,(this.scheduler=e)||1!==t.length||(this._isScalar=!0,this.value=t[0])}return n(o,r),o.create=function(t,e){return new o(t,e)},o.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t[t.length-1];a.isScheduler(r)?t.pop():r=null;var n=t.length;return 1<n?new o(t,r):1===n?new s.ScalarObservable(t[0],r):new u.EmptyObservable(r)},o.dispatch=function(t){var e=t.array,r=t.index,n=t.count,i=t.subscriber;n<=r?i.complete():(i.next(e[r]),i.closed||(t.index=r+1,this.schedule(t)))},o.prototype._subscribe=function(t){var e=this.array,r=e.length,n=this.scheduler;if(n)return n.schedule(o.dispatch,0,{array:e,index:0,count:r,subscriber:t});for(var i=0;i<r&&!t.closed;i++)t.next(e[i]);t.complete()},o}(i.Observable);r.ArrayObservable=o},{"../Observable":4,"../util/isScheduler":60,"./EmptyObservable":23,"./ScalarObservable":28}],23:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(e){function r(t){e.call(this),this.scheduler=t}return n(r,e),r.create=function(t){return new r(t)},r.dispatch=function(t){t.subscriber.complete()},r.prototype._subscribe=function(t){var e=this.scheduler;if(e)return e.schedule(r.dispatch,0,{subscriber:t});t.complete()},r}(t("../Observable").Observable);r.EmptyObservable=i},{"../Observable":4}],24:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=t("../Observable"),o=t("../util/tryCatch"),s=t("../util/isFunction"),u=t("../util/errorObject"),y=t("../Subscription"),m=Object.prototype.toString;var a=function(i){function v(t,e,r,n){i.call(this),this.sourceObj=t,this.eventName=e,this.selector=r,this.options=n}return n(v,i),v.create=function(t,e,r,n){return s.isFunction(r)&&(n=r,r=void 0),new v(t,e,n,r)},v.setupSubscription=function(t,e,r,n,i){var o,s,u,a,c,l;if((l=t)&&"[object NodeList]"===m.call(l)||(c=t)&&"[object HTMLCollection]"===m.call(c))for(var f=0,h=t.length;f<h;f++)v.setupSubscription(t[f],e,r,n,i);else if((a=t)&&"function"==typeof a.addEventListener&&"function"==typeof a.removeEventListener){var p=t;t.addEventListener(e,r,i),o=function(){return p.removeEventListener(e,r,i)}}else if((u=t)&&"function"==typeof u.on&&"function"==typeof u.off){var d=t;t.on(e,r),o=function(){return d.off(e,r)}}else{if(!(s=t)||"function"!=typeof s.addListener||"function"!=typeof s.removeListener)throw new TypeError("Invalid event target");var b=t;t.addListener(e,r),o=function(){return b.removeListener(e,r)}}n.add(new y.Subscription(o))},v.prototype._subscribe=function(n){var t=this.sourceObj,e=this.eventName,r=this.options,i=this.selector;v.setupSubscription(t,e,i?function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=o.tryCatch(i).apply(void 0,t);r===u.errorObject?n.error(u.errorObject.e):n.next(r)}:function(t){return n.next(t)},n,r)},v}(i.Observable);r.FromEventObservable=a},{"../Observable":4,"../Subscription":10,"../util/errorObject":54,"../util/isFunction":57,"../util/tryCatch":66}],25:[function(t,e,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=t("../util/isArray"),u=t("../util/isArrayLike"),a=t("../util/isPromise"),c=t("./PromiseObservable"),l=t("./IteratorObservable"),f=t("./ArrayObservable"),h=t("./ArrayLikeObservable"),p=t("../symbol/iterator"),d=t("../Observable"),b=t("../operators/observeOn"),v=t("../symbol/observable"),n=function(r){function n(t,e){r.call(this,null),this.ish=t,this.scheduler=e}return o(n,r),n.create=function(t,e){if(null!=t){if("function"==typeof t[v.observable])return t instanceof d.Observable&&!e?t:new n(t,e);if(s.isArray(t))return new f.ArrayObservable(t,e);if(a.isPromise(t))return new c.PromiseObservable(t,e);if("function"==typeof t[p.iterator]||"string"==typeof t)return new l.IteratorObservable(t,e);if(u.isArrayLike(t))return new h.ArrayLikeObservable(t,e)}throw new TypeError((null!==t&&(void 0===t?"undefined":i(t))||t)+" is not observable")},n.prototype._subscribe=function(t){var e=this.ish,r=this.scheduler;return null==r?e[v.observable]().subscribe(t):e[v.observable]().subscribe(new b.ObserveOnSubscriber(t,r,0))},n}(d.Observable);r.FromObservable=n},{"../Observable":4,"../operators/observeOn":45,"../symbol/iterator":48,"../symbol/observable":49,"../util/isArray":55,"../util/isArrayLike":56,"../util/isPromise":59,"./ArrayLikeObservable":21,"./ArrayObservable":22,"./IteratorObservable":26,"./PromiseObservable":27}],26:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=t("../util/root"),i=t("../Observable"),s=t("../symbol/iterator"),u=function(r){function i(t,e){if(r.call(this),this.scheduler=e,null==t)throw new Error("iterator cannot be null.");this.iterator=function(t){var e=t[s.iterator];if(!e&&"string"==typeof t)return new a(t);if(!e&&void 0!==t.length)return new c(t);if(!e)throw new TypeError("object is not iterable");return t[s.iterator]()}(t)}return n(i,r),i.create=function(t,e){return new i(t,e)},i.dispatch=function(t){var e=t.index,r=t.hasError,n=t.iterator,i=t.subscriber;if(r)i.error(t.error);else{var o=n.next();o.done?i.complete():(i.next(o.value),t.index=e+1,i.closed?"function"==typeof n.return&&n.return():this.schedule(t))}},i.prototype._subscribe=function(t){var e=this.iterator,r=this.scheduler;if(r)return r.schedule(i.dispatch,0,{index:0,iterator:e,subscriber:t});for(;;){var n=e.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed){"function"==typeof e.return&&e.return();break}}},i}(i.Observable);r.IteratorObservable=u;var a=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.length),this.str=t,this.idx=e,this.len=r}return t.prototype[s.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),c=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=function(t){var e=+t.length;if(isNaN(e))return 0;if(0===e||(r=e,"number"!=typeof r||!o.root.isFinite(r)))return e;var r;if(n=e,i=+n,(e=(0===i?i:isNaN(i)?i:i<0?-1:1)*Math.floor(Math.abs(e)))<=0)return 0;var n,i;if(l<e)return l;return e}(t)),this.arr=t,this.idx=e,this.len=r}return t.prototype[s.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}();var l=Math.pow(2,53)-1},{"../Observable":4,"../symbol/iterator":48,"../util/root":63}],27:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=t("../util/root"),n=function(r){function n(t,e){r.call(this),this.promise=t,this.scheduler=e}return i(n,r),n.create=function(t,e){return new n(t,e)},n.prototype._subscribe=function(e){var r=this,t=this.promise,n=this.scheduler;if(null==n)this._isScalar?e.closed||(e.next(this.value),e.complete()):t.then(function(t){r.value=t,r._isScalar=!0,e.closed||(e.next(t),e.complete())},function(t){e.closed||e.error(t)}).then(null,function(t){o.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!e.closed)return n.schedule(s,0,{value:this.value,subscriber:e})}else t.then(function(t){r.value=t,r._isScalar=!0,e.closed||e.add(n.schedule(s,0,{value:t,subscriber:e}))},function(t){e.closed||e.add(n.schedule(u,0,{err:t,subscriber:e}))}).then(null,function(t){o.root.setTimeout(function(){throw t})})},n}(t("../Observable").Observable);function s(t){var e=t.value,r=t.subscriber;r.closed||(r.next(e),r.complete())}function u(t){var e=t.err,r=t.subscriber;r.closed||r.error(e)}r.PromiseObservable=n},{"../Observable":4,"../util/root":63}],28:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=function(r){function n(t,e){r.call(this),this.value=t,this.scheduler=e,this._isScalar=!0,e&&(this._isScalar=!1)}return i(n,r),n.create=function(t,e){return new n(t,e)},n.dispatch=function(t){var e=t.done,r=t.value,n=t.subscriber;e?n.complete():(n.next(r),n.closed||(t.done=!0,this.schedule(t)))},n.prototype._subscribe=function(t){var e=this.value,r=this.scheduler;if(r)return r.schedule(n.dispatch,0,{done:!1,value:e,subscriber:t});t.next(e),t.closed||t.complete()},n}(t("../Observable").Observable);r.ScalarObservable=n},{"../Observable":4}],29:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=t("../../util/root"),f=t("../../util/tryCatch"),h=t("../../util/errorObject"),n=t("../../Observable"),o=t("../../Subscriber"),s=t("../../operators/map");function a(t,e){return void 0===e&&(e=null),new y({method:"GET",url:t,headers:e})}function c(t,e,r){return new y({method:"POST",url:t,body:e,headers:r})}function l(t,e){return new y({method:"DELETE",url:t,headers:e})}function p(t,e,r){return new y({method:"PUT",url:t,body:e,headers:r})}function d(t,e,r){return new y({method:"PATCH",url:t,body:e,headers:r})}r.ajaxGet=a,r.ajaxPost=c,r.ajaxDelete=l,r.ajaxPut=p,r.ajaxPatch=d;var b=s.map(function(t,e){return t.response});function v(t,e){return b(new y({method:"GET",url:t,responseType:"json",headers:e}))}r.ajaxGetJSON=v;var y=function(n){function e(t){n.call(this);var e={async:!0,createXHR:function(){return this.crossDomain?function(){if(u.root.XMLHttpRequest)return new u.root.XMLHttpRequest;if(u.root.XDomainRequest)return new u.root.XDomainRequest;throw new Error("CORS is not supported by your browser")}.call(this):function(){if(u.root.XMLHttpRequest)return new u.root.XMLHttpRequest;var t=void 0;try{for(var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=0;r<3;r++)try{if(t=e[r],new u.root.ActiveXObject(t))break}catch(t){}return new u.root.ActiveXObject(t)}catch(t){throw new Error("XMLHttpRequest is not supported by your browser")}}()},crossDomain:!1,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof t)e.url=t;else for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);this.request=e}var t;return i(e,n),e.prototype._subscribe=function(t){return new m(t,this.request)},e.create=((t=function(t){return new e(t)}).get=a,t.post=c,t.delete=l,t.put=p,t.patch=d,t.getJSON=v,t),e}(n.Observable);r.AjaxObservable=y;var m=function(n){function t(t,e){n.call(this,t),this.request=e,this.done=!1;var r=e.headers=e.headers||{};e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),"Content-Type"in r||u.root.FormData&&e.body instanceof u.root.FormData||void 0===e.body||(r["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),e.body=this.serializeBody(e.body,e.headers["Content-Type"]),this.send()}return i(t,n),t.prototype.next=function(t){this.done=!0;var e=this.xhr,r=this.request,n=this.destination,i=new g(t,e,r);n.next(i)},t.prototype.send=function(){var t=this.request,e=this.request,r=e.user,n=e.method,i=e.url,o=e.async,s=e.password,u=e.headers,a=e.body,c=t.createXHR,l=f.tryCatch(c).call(t);if(l===h.errorObject)this.error(h.errorObject.e);else{this.xhr=l,this.setupEvents(l,t);if((r?f.tryCatch(l.open).call(l,n,i,o,r,s):f.tryCatch(l.open).call(l,n,i,o))===h.errorObject)return this.error(h.errorObject.e),null;if(o&&(l.timeout=t.timeout,l.responseType=t.responseType),"withCredentials"in l&&(l.withCredentials=!!t.withCredentials),this.setHeaders(l,u),(a?f.tryCatch(l.send).call(l,a):f.tryCatch(l.send).call(l))===h.errorObject)return this.error(h.errorObject.e),null}return l},t.prototype.serializeBody=function(e,t){if(!e||"string"==typeof e)return e;if(u.root.FormData&&e instanceof u.root.FormData)return e;if(t){var r=t.indexOf(";");-1!==r&&(t=t.substring(0,r))}switch(t){case"application/x-www-form-urlencoded":return Object.keys(e).map(function(t){return encodeURI(t)+"="+encodeURI(e[t])}).join("&");case"application/json":return JSON.stringify(e);default:return e}},t.prototype.setHeaders=function(t,e){for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},t.prototype.setupEvents=function(t,e){var r=e.progressSubscriber;function i(t){var e=i.subscriber,r=i.progressSubscriber,n=i.request;r&&r.error(t),e.error(new O(this,n))}if((t.ontimeout=i).request=e,i.subscriber=this,i.progressSubscriber=r,t.upload&&"withCredentials"in t){var n,o;if(r)n=function(t){n.progressSubscriber.next(t)},u.root.XDomainRequest?t.onprogress=n:t.upload.onprogress=n,n.progressSubscriber=r;o=function(t){var e=o,r=e.progressSubscriber,n=e.subscriber,i=e.request;r&&r.error(t),n.error(new w("ajax error",this,i))},(t.onerror=o).request=e,o.subscriber=this,o.progressSubscriber=r}function s(t){var e=s.subscriber,r=s.progressSubscriber,n=s.request;if(4===this.readyState){var i=1223===this.status?204:this.status,o="text"===this.responseType?this.response||this.responseText:this.response;0===i&&(i=o?200:0),200<=i&&i<300?(r&&r.complete(),e.next(t),e.complete()):(r&&r.error(t),e.error(new w("ajax error "+i,this,n)))}}(t.onreadystatechange=s).subscriber=this,s.progressSubscriber=r,s.request=e},t.prototype.unsubscribe=function(){var t=this.done,e=this.xhr;!t&&e&&4!==e.readyState&&"function"==typeof e.abort&&e.abort(),n.prototype.unsubscribe.call(this)},t}(o.Subscriber);r.AjaxSubscriber=m;var g=function(t,e,r){this.originalEvent=t,this.xhr=e,this.request=r,this.status=e.status,this.responseType=e.responseType||r.responseType,this.response=_(this.responseType,e)};r.AjaxResponse=g;var w=function(n){function t(t,e,r){n.call(this,t),this.message=t,this.xhr=e,this.request=r,this.status=e.status,this.responseType=e.responseType||r.responseType,this.response=_(this.responseType,e)}return i(t,n),t}(Error);function _(t,e){switch(t){case"json":return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null");case"xml":return e.responseXML;case"text":default:return"response"in e?e.response:e.responseText}}var O=function(r){function t(t,e){r.call(this,"ajax timeout",t,e)}return i(t,r),t}(r.AjaxError=w);r.AjaxTimeoutError=O},{"../../Observable":4,"../../Subscriber":9,"../../operators/map":43,"../../util/errorObject":54,"../../util/root":63,"../../util/tryCatch":66}],30:[function(t,e,r){"use strict";var n=t("./FromObservable");r.from=n.FromObservable.create},{"./FromObservable":25}],31:[function(t,e,r){"use strict";var n=t("./FromEventObservable");r.fromEvent=n.FromEventObservable.create},{"./FromEventObservable":24}],32:[function(t,e,r){"use strict";var n=t("./PromiseObservable");r.fromPromise=n.PromiseObservable.create},{"./PromiseObservable":27}],33:[function(t,e,r){"use strict";var n=t("../operators/catchError");r._catch=function(t){return n.catchError(t)(this)}},{"../operators/catchError":40}],34:[function(t,e,r){"use strict";var n=t("../operators/distinct");r.distinct=function(t,e){return n.distinct(t,e)(this)}},{"../operators/distinct":41}],35:[function(t,e,r){"use strict";var n=t("../operators/filter");r.filter=function(t,e){return n.filter(t,e)(this)}},{"../operators/filter":42}],36:[function(t,e,r){"use strict";var n=t("../operators/map");r.map=function(t,e){return n.map(t,e)(this)}},{"../operators/map":43}],37:[function(t,e,r){"use strict";var n=t("../operators/mergeMap");r.mergeMap=function(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),n.mergeMap(t,e,r)(this)}},{"../operators/mergeMap":44}],38:[function(t,e,r){"use strict";var n=t("../operators/retry");r.retry=function(t){return void 0===t&&(t=-1),n.retry(t)(this)}},{"../operators/retry":46}],39:[function(t,e,r){"use strict";var n=t("../operators/retryWhen");r.retryWhen=function(t){return n.retryWhen(t)(this)}},{"../operators/retryWhen":47}],40:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../OuterSubscriber"),o=t("../util/subscribeToResult");r.catchError=function(n){return function(t){var e=new s(n),r=t.lift(e);return e.caught=r}};var s=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.selector,this.caught))},t}(),u=function(n){function t(t,e,r){n.call(this,t),this.selector=e,this.caught=r}return i(t,n),t.prototype.error=function(t){if(!this.isStopped){var e=void 0;try{e=this.selector(t,this.caught)}catch(t){return void n.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),this.add(o.subscribeToResult(this,e))}},t}(n.OuterSubscriber)},{"../OuterSubscriber":6,"../util/subscribeToResult":64}],41:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../OuterSubscriber"),o=t("../util/subscribeToResult"),s=t("../util/Set");r.distinct=function(e,r){return function(t){return t.lift(new u(e,r))}};var u=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.keySelector,this.flushes))},t}(),a=function(n){function t(t,e,r){n.call(this,t),this.keySelector=e,this.values=new s.Set,r&&this.add(o.subscribeToResult(this,r))}return i(t,n),t.prototype.notifyNext=function(t,e,r,n,i){this.values.clear()},t.prototype.notifyError=function(t,e){this._error(t)},t.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},t.prototype._useKeySelector=function(t){var e,r=this.destination;try{e=this.keySelector(t)}catch(t){return void r.error(t)}this._finalizeNext(e,t)},t.prototype._finalizeNext=function(t,e){var r=this.values;r.has(t)||(r.add(t),this.destination.next(e))},t}(n.OuterSubscriber);r.DistinctSubscriber=a},{"../OuterSubscriber":6,"../util/Set":52,"../util/subscribeToResult":64}],42:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../Subscriber");r.filter=function(e,r){return function(t){return t.lift(new o(e,r))}};var o=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.predicate,this.thisArg))},t}(),s=function(n){function t(t,e,r){n.call(this,t),this.predicate=e,this.thisArg=r,this.count=0}return i(t,n),t.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},t}(n.Subscriber)},{"../Subscriber":9}],43:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../Subscriber");r.map=function(e,r){return function(t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new o(e,r))}};var o=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.thisArg))},t}();r.MapOperator=o;var s=function(n){function t(t,e,r){n.call(this,t),this.project=e,this.count=0,this.thisArg=r||this}return i(t,n),t.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},t}(n.Subscriber)},{"../Subscriber":9}],44:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=t("../util/subscribeToResult"),i=t("../OuterSubscriber");r.mergeMap=function(e,r,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(t){return"number"==typeof r&&(n=r,r=null),t.lift(new s(e,r,n))}};var s=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.project=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.project,this.resultSelector,this.concurrent))},t}();r.MergeMapOperator=s;var u=function(i){function t(t,e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY),i.call(this,t),this.project=e,this.resultSelector=r,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return n(t,i),t.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},t.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},t.prototype._innerSub=function(t,e,r){this.add(o.subscribeToResult(this,t,e,r))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(t,e,r,n,i){this.resultSelector?this._notifyResultSelector(t,e,r,n):this.destination.next(e)},t.prototype._notifyResultSelector=function(t,e,r,n){var i;try{i=this.resultSelector(t,e,r,n)}catch(t){return void this.destination.error(t)}this.destination.next(i)},t.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(i.OuterSubscriber);r.MergeMapSubscriber=u},{"../OuterSubscriber":6,"../util/subscribeToResult":64}],45:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../Subscriber"),o=t("../Notification");r.observeOn=function(e,r){return void 0===r&&(r=0),function(t){return t.lift(new s(e,r))}};var s=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))},t}();r.ObserveOnOperator=s;var u=function(n){function e(t,e,r){void 0===r&&(r=0),n.call(this,t),this.scheduler=e,this.delay=r}return i(e,n),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new a(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(o.Notification.createComplete())},e}(n.Subscriber);r.ObserveOnSubscriber=u;var a=function(t,e){this.notification=t,this.destination=e};r.ObserveOnMessage=a},{"../Notification":3,"../Subscriber":9}],46:[function(t,e,r){"use strict";var i=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n=t("../Subscriber");r.retry=function(e){return void 0===e&&(e=-1),function(t){return t.lift(new o(e,t))}};var o=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.count,this.source))},t}(),s=function(n){function t(t,e,r){n.call(this,t),this.count=e,this.source=r}return i(t,n),t.prototype.error=function(t){if(!this.isStopped){var e=this.source,r=this.count;if(0===r)return n.prototype.error.call(this,t);-1<r&&(this.count=r-1),e.subscribe(this._unsubscribeAndRecycle())}},t}(n.Subscriber)},{"../Subscriber":9}],47:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=t("../Subject"),s=t("../util/tryCatch"),u=t("../util/errorObject"),i=t("../OuterSubscriber"),a=t("../util/subscribeToResult");r.retryWhen=function(e){return function(t){return t.lift(new c(e,t))}};var c=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.notifier,this.source))},t}(),l=function(i){function t(t,e,r){i.call(this,t),this.notifier=e,this.source=r}return n(t,i),t.prototype.error=function(t){if(!this.isStopped){var e=this.errors,r=this.retries,n=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{if(e=new o.Subject,(r=s.tryCatch(this.notifier)(e))===u.errorObject)return i.prototype.error.call(this,u.errorObject.e);n=a.subscribeToResult(this,r)}this._unsubscribeAndRecycle(),this.errors=e,this.retries=r,this.retriesSubscription=n,e.next(t)}},t.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype.notifyNext=function(t,e,r,n,i){var o=this.errors,s=this.retries,u=this.retriesSubscription;this.errors=null,this.retries=null,this.retriesSubscription=null,this._unsubscribeAndRecycle(),this.errors=o,this.retries=s,this.retriesSubscription=u,this.source.subscribe(this)},t}(i.OuterSubscriber)},{"../OuterSubscriber":6,"../Subject":7,"../util/errorObject":54,"../util/subscribeToResult":64,"../util/tryCatch":66}],48:[function(t,e,r){"use strict";var n=t("../util/root");function i(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var r=t.Set;if(r&&"function"==typeof(new r)["@@iterator"])return"@@iterator";var n=t.Map;if(n)for(var i=Object.getOwnPropertyNames(n.prototype),o=0;o<i.length;++o){var s=i[o];if("entries"!==s&&"size"!==s&&n.prototype[s]===n.prototype.entries)return s}return"@@iterator"}r.symbolIteratorPonyfill=i,r.iterator=i(n.root),r.$$iterator=r.iterator},{"../util/root":63}],49:[function(t,e,r){"use strict";var n=t("../util/root");function i(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}r.getSymbolObservable=i,r.observable=i(n.root),r.$$observable=r.observable},{"../util/root":63}],50:[function(t,e,r){"use strict";var n=t("../util/root").root.Symbol;r.rxSubscriber="function"==typeof n&&"function"==typeof n.for?n.for("rxSubscriber"):"@@rxSubscriber",r.$$rxSubscriber=r.rxSubscriber},{"../util/root":63}],51:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(e){function t(){var t=e.call(this,"object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}return n(t,e),t}(Error);r.ObjectUnsubscribedError=i},{}],52:[function(t,e,r){"use strict";var n=t("./root");function i(){return function(){function t(){this._values=[]}return t.prototype.add=function(t){this.has(t)||this._values.push(t)},t.prototype.has=function(t){return-1!==this._values.indexOf(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._values.length=0},t}()}r.minimalSetImpl=i,r.Set=n.root.Set||i()},{"./root":63}],53:[function(t,e,r){"use strict";var n=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(r){function t(t){r.call(this),this.errors=t;var e=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=e.name="UnsubscriptionError",this.stack=e.stack,this.message=e.message}return n(t,r),t}(Error);r.UnsubscriptionError=i},{}],54:[function(t,e,r){"use strict";r.errorObject={e:{}}},{}],55:[function(t,e,r){"use strict";r.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},{}],56:[function(t,e,r){"use strict";r.isArrayLike=function(t){return t&&"number"==typeof t.length}},{}],57:[function(t,e,r){"use strict";r.isFunction=function(t){return"function"==typeof t}},{}],58:[function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r.isObject=function(t){return null!=t&&"object"===(void 0===t?"undefined":n(t))}},{}],59:[function(t,e,r){"use strict";r.isPromise=function(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}},{}],60:[function(t,e,r){"use strict";r.isScheduler=function(t){return t&&"function"==typeof t.schedule}},{}],61:[function(t,e,r){"use strict";r.noop=function(){}},{}],62:[function(t,e,r){"use strict";var n=t("./noop");function i(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:n.noop}r.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return i(t)},r.pipeFromArray=i},{"./noop":61}],63:[function(t,e,i){(function(t){"use strict";var e="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,n=e||void 0!==t&&t||r;i.root=n,function(){if(!n)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],64:[function(t,e,r){"use strict";var f=t("./root"),h=t("./isArrayLike"),p=t("./isPromise"),d=t("./isObject"),b=t("../Observable"),v=t("../symbol/iterator"),y=t("../InnerSubscriber"),m=t("../symbol/observable");r.subscribeToResult=function(t,e,r,n){var i=new y.InnerSubscriber(t,r,n);if(i.closed)return null;if(e instanceof b.Observable)return e._isScalar?(i.next(e.value),i.complete(),null):(i.syncErrorThrowable=!0,e.subscribe(i));if(h.isArrayLike(e)){for(var o=0,s=e.length;o<s&&!i.closed;o++)i.next(e[o]);i.closed||i.complete()}else{if(p.isPromise(e))return e.then(function(t){i.closed||(i.next(t),i.complete())},function(t){return i.error(t)}).then(null,function(t){f.root.setTimeout(function(){throw t})}),i;if(e&&"function"==typeof e[v.iterator])for(var u=e[v.iterator]();;){var a=u.next();if(a.done){i.complete();break}if(i.next(a.value),i.closed)break}else if(e&&"function"==typeof e[m.observable]){var c=e[m.observable]();if("function"==typeof c.subscribe)return c.subscribe(new y.InnerSubscriber(t,r,n));i.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var l="You provided "+(d.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";i.error(new TypeError(l))}}return null}},{"../InnerSubscriber":2,"../Observable":4,"../symbol/iterator":48,"../symbol/observable":49,"./isArrayLike":56,"./isObject":58,"./isPromise":59,"./root":63}],65:[function(t,e,r){"use strict";var n=t("../Subscriber"),i=t("../symbol/rxSubscriber"),o=t("../Observer");r.toSubscriber=function(t,e,r){if(t){if(t instanceof n.Subscriber)return t;if(t[i.rxSubscriber])return t[i.rxSubscriber]()}return t||e||r?new n.Subscriber(t,e,r):new n.Subscriber(o.empty)}},{"../Observer":5,"../Subscriber":9,"../symbol/rxSubscriber":50}],66:[function(t,e,r){"use strict";var n,i=t("./errorObject");function o(){try{return n.apply(this,arguments)}catch(t){return i.errorObject.e=t,i.errorObject}}r.tryCatch=function(t){return n=t,o}},{"./errorObject":54}],67:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),i=t("rxjs/Observable"),s=t("rxjs/observable/dom/AjaxObservable");t("rxjs/add/operator/map"),t("rxjs/add/operator/filter"),t("rxjs/add/operator/mergeMap"),t("rxjs/add/operator/distinct"),t("rxjs/add/operator/catch"),t("rxjs/add/observable/from"),t("rxjs/add/observable/fromEvent"),t("rxjs/add/observable/fromPromise"),t("rxjs/add/operator/retry"),t("rxjs/add/operator/retryWhen");var o,u=t("dexie"),a=(o=u)&&o.__esModule?o:{default:o};var c=function(){function o(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o)}return n(o,null,[{key:"createIndexedDB",value:function(t){return new a.default(t)}},{key:"getIndexedRestaurants",value:function(t){return i.Observable.fromPromise(t[o.DATABASE_NAME].toArray()).mergeMap(function(t){return t})}},{key:"getIndexedReviews",value:function(t){return i.Observable.fromPromise(t.reviews.toArray()).mergeMap(function(t){return t})}},{key:"createIndexedStores",value:function(e,r){try{return e.version(o.DATABASE_VERSION).stores(r)}catch(t){if("Cannot add version when database is open"===t.message)return e.close(),e.version(o.DATABASE_VERSION).stores(r),e.open()}}},{key:"deleteIndexedDB",value:function(t){return t.delete()}},{key:"initIndexedDB",value:function(t){return t.open()}},{key:"addIDBEventListener",value:function(t,e,r){t.on(e,r)}},{key:"ifIndexedDBEmpty",value:function(t,n){return new Promise(function(e,r){o.addIDBEventListener(t,"ready",function(){return t[n].count(function(t){return 0===t?e():r("DB not empty")})})})}},{key:"indexedTableOpen",value:function(t,e){return t.transaction("rw",o.DATABASE_NAME,function(){return e()})}},{key:"fetchRestaurants",value:function(t){return s.AjaxObservable.create.getJSON(o.API_URL).retry(2).mergeMap(function(t){return i.Observable.from(t)}).catch(function(){return o.getIndexedRestaurants(t)})}},{key:"fetchReviewsByID",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return s.AjaxObservable.create.getJSON("./"+e+"reviews/?restaurant_id="+t)}},{key:"addReviewByRestaurant",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return s.AjaxObservable.create.post("./"+e+"reviews/",t)}},{key:"removeReviewByID",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return s.AjaxObservable.create.delete("./"+e+"reviews/"+t)}},{key:"entryExists",value:function(n,i){return new Promise(function(e,r){n.transaction("rw",o.DATABASE_NAME,function(){var t;(t=n[o.DATABASE_NAME]).get.apply(t,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(i)).then(function(t){return e(t)}).catch(function(t){r(t)})})})}},{key:"needsUpdate",value:function(){return new Promise(function(t,e){var r=new XMLHttpRequest;r.open("HEAD",url),r.onreadystatechange=function(){this.readyState===this.DONE?304!==this.status&&404!==this.status&&t():e()},r.send()})}},{key:"fetchRestaurantById",value:function(e,t){return s.AjaxObservable.create.getJSON(""+o.API_URL+e).catch(function(){return o.getIndexedRestaurants(t).filter(function(t){return t.id===Number(e)})})}},{key:"fetchRestaurantByCuisine",value:function(t,e,r){return t.filter(function(t){return t.cuisine_type===e}).subscribe(function(t){return r(null,t)},function(t){return r(t,null)})}},{key:"fetchRestaurantByNeighborhood",value:function(t,e,r){return t.filter(function(t){return t.neighborhood===e}).subscribe(function(t){return r(null,t)},function(t){return r(t,null)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,e,r){return t.filter(function(t){return("all"!==e&&t.cuisine_type===e||"all"===e)&&("all"!==r&&t.neighborhood===r||"all"===r)})}},{key:"fetchNeighborhoods",value:function(t){return t.map(function(t){return t.neighborhood}).distinct()}},{key:"fetchCuisines",value:function(t){return t.map(function(t){return t.cuisine_type}).distinct()}},{key:"mapMarkerForRestaurant",value:function(t,e){return new google.maps.Marker({position:t.latlng,title:t.name,url:o.urlForRestaurant(t),map:e,animation:google.maps.Animation.DROP})}},{key:"API_URL",get:function(){return"/restaurants/"}},{key:"DATABASE_NAME",get:function(){return"restaurants"}},{key:"DATABASE_VERSION",get:function(){return 1}}]),o}();c.setFavorite=function(t,e){return s.AjaxObservable.create.put("./restaurants/"+t+"/?is_favorite="+e)},c.urlForRestaurant=function(t){return"./review/"+t.id},c.imageUrlForRestaurant=function(t){return"./../img/"+t.photograph},r.default=c},{dexie:1,"rxjs/Observable":4,"rxjs/add/observable/from":11,"rxjs/add/observable/fromEvent":12,"rxjs/add/observable/fromPromise":13,"rxjs/add/operator/catch":14,"rxjs/add/operator/distinct":15,"rxjs/add/operator/filter":16,"rxjs/add/operator/map":17,"rxjs/add/operator/mergeMap":18,"rxjs/add/operator/retry":19,"rxjs/add/operator/retryWhen":20,"rxjs/observable/dom/AjaxObservable":29}],68:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDataAttributes=r.createResponsiveImg=void 0;var n,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},o=t("./DBHelper"),a=(n=o)&&n.__esModule?n:{default:n},s=t("rxjs/Observable"),c=t("rxjs/Subject");t("rxjs/add/operator/map"),t("rxjs/add/operator/mergeMap"),t("rxjs/add/operator/filter"),t("rxjs/add/observable/from"),t("rxjs/add/observable/fromEvent");var l=t("./toast");function f(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var u=function o(){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.state={restaurants:null,neighborhoods:[],cuisines:[],map:null,markers:[],indexedDB:null,thumbnails:[]},this.ONLINE$=s.Observable.fromEvent(window,"online"),this.OFFLINE$=s.Observable.fromEvent(window,"offline").subscribe(function(){(0,l.toast)("It looks, you're offline. All requests will be send after connection reestablishing.","info")}),this.setState=function(t){return u.state=i({},u.state,t)},this.removeFavoriteListeners=function(){[].concat(f(document.getElementsByClassName("markAsFavorite"))).map(function(t){return t.removeEventListener("click",t)})},this.setFavoriteListeners=function(){u.removeFavoriteListeners(),[].concat(f(document.getElementsByClassName("markAsFavorite"))).map(function(i){return i.addEventListener("click",function(t){t.preventDefault();var e=o.getDataAttributes(i.attributes),r=e.id,n=e.favorite;u.toggleFavorite(Number(r),JSON.parse(n),i)})})},this.fetchNeighborhoods=function(){var t=function(t){return u.state.neighborhoods=[],a.default.fetchNeighborhoods(t).subscribe(function(t){u.state.neighborhoods.push(t),u.fillNeighborhoodsHTML(t)},function(t){return console.error(t)})};u.state.restaurants&&0!==u.state.restaurants.length?t(u.state.restaurants):t(u.setRestaurants())},this.fillNeighborhoodsHTML=function(t){var e=document.getElementById("neighborhoods-select"),r=document.createElement("option");r.innerHTML=t,r.value=t;try{e.append(r)}catch(t){e.innerHTML+=r.outerHTML}return r},this.fetchCuisines=function(){u.state.cuisines=[],a.default.fetchCuisines(u.state.restaurants).subscribe(function(t){u.state.cuisines.push(t),u.fillCuisinesHTML(t)},function(t){return console.error(t)})},this.fillCuisinesHTML=function(t){var e=document.getElementById("cuisines-select"),r=document.createElement("option");r.innerHTML=t,r.value=t;try{e.append(r)}catch(t){e.innerHTML+=r.outerHTML}return r},this.setRestaurants=function(){u.state.restaurants=new c.Subject;var e=a.default.createIndexedDB(a.default.DATABASE_NAME);return a.default.createIndexedStores(e,{restaurants:"id++,name,neighborhood,cuisine_type"}),u.resetRestaurants(),u.setState({indexedDB:e}),a.default.fetchRestaurants(e).map(function(t){return u.storeThumbnails(t),u.addMarkersToMap(t),u.state.restaurants.next(t),e[a.default.DATABASE_NAME].put(t).catch(console.error),t},function(t){return console.error(t)})},this.toggleFavorite=function(t,e,r){a.default.setFavorite(t,!e).retryWhen(function(){return u.ONLINE$}).subscribe(function(){var t=r.children[0];r.setAttribute("data-favorite",!e),r.setAttribute("aria-checked",!e),e?r.setAttribute("aria-label","Unmark as favorite"):r.setAttribute("aria-label","Mark as favorite"),t.className="star "+(e?"":"favorite"),t.src=e?"./img/star_unchecked.png":"./img/star.png"})},this.updateRestaurants=function(){var t=document.getElementById("cuisines-select"),e=document.getElementById("neighborhoods-select"),r=t.selectedIndex,n=e.selectedIndex,i=t[r].value,o=e[n].value,s=u.state.indexedDB;u.resetRestaurants(),a.default.fetchRestaurantByCuisineAndNeighborhood(a.default.fetchRestaurants(s),i,o).subscribe(function(t){u.storeThumbnails(t),u.addMarkersToMap(t)},function(t){return console.error(t)})},this.resetRestaurants=function(){u.state.thumbnails.length=0;var t=document.getElementById("restaurants-list");u.removeFavoriteListeners(),t.innerHTML="",u.state.markers=u.state.markers?u.state.markers:[],u.state.markers.forEach(function(t){return t.setMap(null)})},this.storeThumbnails=function(t){u.state.thumbnails.push({HTML:u.createRestaurantHTML(t),visible:!1})},this.fillRestaurantsHTML=function(e){var r=document.getElementById("restaurants-list");try{r.append(e)}catch(t){r.innerHTML+=e.outerHTML}},this.createRestaurantHTML=function(t){var e=document.createElement("div"),r="n"+String(Math.random()).split(".")[1],n=JSON.parse(void 0!==t.is_favorite?t.is_favorite:"false");return e.innerHTML=('<li role="banner" aria-labelledby="'+r+'">\n<div id="'+r+'">\n<button class="markAsFavorite" aria-label="Mark as favorite" aria-live="assertive" role="switch" aria-checked="false" data-id="'+t.id+'" data-favorite="'+n+'">\n<img class="star '+(n?"favorite":"")+'" src="'+(n?"./img/star.png":"./img/star_unchecked.png")+'"\n alt="'+(n?"is favorite":"isn't favorite")+'">\n</button>\n<h2 role="heading">'+t.name+"</h2>\n<p>"+t.neighborhood+"</p>\n<p>"+t.address+'</p>\n</div>\n<a role="link" href="'+a.default.urlForRestaurant(t)+'">View Details</a></li>').replace(/>\s+</,"><"),[e.firstChild,o.createResponsiveImg(a.default.imageUrlForRestaurant(t),"Image of "+t.name+" restaurant")]},this.addMarkersToMap=function(t){var e=a.default.mapMarkerForRestaurant(t,u.state.map);google.maps.event.addListener(e,"click",function(){window.location.href=e.url}),u.state.markers.push(e)},document.getElementById("load-restaurants").addEventListener("click",function(t){t.preventDefault(),u.state.thumbnails.map(function(t){t.HTML[0].innerHTML=t.HTML[1]+t.HTML[0].innerHTML,u.fillRestaurantsHTML(t.HTML[0]),t.visible=!0}),u.setFavoriteListeners()})};u.getDataAttributes=function(t){var e=[].concat(f(t)).filter(function(t){return/data/.test(t.name)}),r={};for(var n in e){var i=e[n],o=i.name,s=i.value;r[o.slice(5,o.length)]=s}return r},u.createResponsiveImg=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:".",n=t.split("."),i=n[n.length-1];return'<picture class="restaurant-img">\n  <source media="(max-width: 719px)"\n    srcset="'+(r+i)+"-100-1x.jpg 1x, "+(r+i)+"-100-2x.jpg 2x, "+(r+i)+'-100-3x.jpg 3x">\n  <source  media="(min-width: 720px)"\n    srcset=".'+t+'.jpg 1x">\n  <img class="restaurant-img" src="'+(r+i)+'.jpg" alt="'+e+'">\n</picture>'},r.default=u;r.createResponsiveImg=u.createResponsiveImg,r.getDataAttributes=u.getDataAttributes},{"./DBHelper":67,"./toast":71,"rxjs/Observable":4,"rxjs/Subject":7,"rxjs/add/observable/from":11,"rxjs/add/observable/fromEvent":12,"rxjs/add/operator/filter":16,"rxjs/add/operator/map":17,"rxjs/add/operator/mergeMap":18}],69:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},o=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),s=t("./DBHelper"),u=(n=s)&&n.__esModule?n:{default:n},a=t("./Restaurant"),c=t("rxjs/Observable"),l=t("./toast");var f=function(){function t(){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state={restaurant:null,map:null,DB:null},this.ONLINE$=c.Observable.fromEvent(window,"online"),this.OFFLINE$=c.Observable.fromEvent(window,"offline").subscribe(function(){(0,l.toast)("It looks, you're offline. All requests will be send after connection reestablishing.","info")}),this.setState=function(t){return s.state=i({},s.state,t)},this.fetchRestaurantFromURL=function(e){if(s.state.restaurant)e(null,s.state.restaurant);else{var r=s.getParameterByName();if(r){var n=u.default.createIndexedDB(u.default.DATABASE_NAME);s.setState({DB:n}),u.default.createIndexedStores(n,{restaurants:"id++,name,neighborhood,cuisine_type",reviews:"id++,name,restaurant_id,createdAt,updatedAt,rating,comments"}),u.default.fetchRestaurantById(r,n).subscribe(function(t){s.state.restaurant=t,console.log(t),n[u.default.DATABASE_NAME].put(t).catch(console.error),e(void 0,t),s.fillRestaurantHTML(t)},function(t){console.error("Got error "+t+" fetching restaurant ID: {"+r+"} from remote")})}else{e("No restaurant id in URL",null)}}},this.fillRestaurantHTML=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:s.state.restaurant;document.getElementById("restaurant-name").innerHTML=t.name,document.getElementById("restaurant-address").innerHTML=t.address,document.getElementById("restaurant-img").outerHTML=(0,a.createResponsiveImg)(u.default.imageUrlForRestaurant(t),"Image of "+t.name+" restaurant","./../.."),document.getElementsByClassName("restaurant-img")[1].id="restaurant-img",document.getElementById("restaurant-cuisine").innerHTML=t.cuisine_type,t.operating_hours&&s.fillRestaurantHoursHTML(),s.fillReviewsHTML(u.default.fetchReviewsByID(s.state.restaurant.id,"../../"))},this.fillRestaurantHoursHTML=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:s.state.restaurant.operating_hours,e=document.getElementById("restaurant-hours");for(var r in t){var n=document.createElement("tr"),i=document.createElement("td");i.innerHTML=r,n.appendChild(i);var o=document.createElement("td");o.innerHTML=t[r],n.appendChild(o),e.appendChild(n)}},this.fillReviewsHTML=function(t){var r=document.getElementById("reviews-container"),e=document.createElement("h3");if(e.innerHTML="Reviews",r.appendChild(e),!t){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void r.appendChild(n)}var i=document.getElementById("reviews-list"),o=s.state.DB;t.catch(function(){return u.default.getIndexedReviews(o)}).mergeMap(function(t){return c.Observable.from(t)}).subscribe(function(t){i.appendChild(s.createReviewHTML(t)),o.reviews.put(t).catch(console.error)},function(t){console.error(t)},function(){r.appendChild(i),[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(i.children)).map(function(t){var e=(0,a.getDataAttributes)(t.attributes).review_id;s.addRemoveReviewListener(t,e)});var t=document.getElementById("maincontent"),e=document.getElementById("overlay");t.style.visibility="visible",e.style.display="none"})},this.createReviewHTML=function(t){var e=new Date(t.updatedAt).toLocaleDateString(),r=document.createElement("div");return r.innerHTML=('<li data-review_id="'+t.id+'"><p>'+t.name+"</p>\n<p>"+e+'</p>\n<p class="review-rating">Rating: '+t.rating+"</p>\n<p>"+t.comments+'</p>\n<button class="remove-review">X</button><button class="edit-review">edit</button></li>').replace(/>\s+</,"><"),r.firstChild},this.fillBreadcrumb=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:s.state.restaurant,e=document.getElementById("breadcrumb"),r=document.createElement("li");r.innerHTML=" "+t.name,e.appendChild(r)},this.getParameterByName=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window.location.pathname).split("/");return t?t[2]?t[2]:"":null},document.getElementById("review-form").addEventListener("submit",function(t){t.preventDefault();var e=document.getElementById("review"),r=document.getElementById("rating"),n=document.getElementById("name"),i=routeChecker()[1],o=new FormData;o.append("name",n.value),o.append("rating",r.value),o.append("comments",e.value),o.append("restaurant_id",i),u.default.addReviewByRestaurant(o,"../").retryWhen(function(){return s.ONLINE$}).subscribe()})}return o(t,[{key:"addRemoveReviewListener",value:function(t,e){var r=this;t.addEventListener("click",function(t){t.preventDefault(),u.default.removeReviewByID(e,"../../").retryWhen(function(){return r.ONLINE$}).subscribe()})}}]),t}();r.default=f},{"./DBHelper":67,"./Restaurant":68,"./toast":71,"rxjs/Observable":4}],70:[function(t,e,r){"use strict";var n=s(t("./Restaurant")),i=s(t("./Review")),o=s(t("./DBHelper"));function s(t){return t&&t.__esModule?t:{default:t}}var u=document.getElementById("neighborhoods-select"),a=document.getElementById("cuisines-select"),c=function(){return location.pathname.match(/([\w_.]+)/g)||["/"]},l=function(e){return e.addEventListener("statechange",function(){if("installed"===e.state)return t=e,void(confirm("Update is ready. Refresh now?")&&t.postMessage({action:"skipWaiting"}));var t})},f=function(r,t){switch(t){case"/":return self.initMap=function(){r.setState({map:new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1})}),r.fetchNeighborhoods(),r.fetchCuisines(),google.maps.event.addListenerOnce(r.state.map,"idle",function(){setTimeout(function(){var t=document.getElementById("maincontent"),e=document.getElementById("overlay");t.style.visibility="visible",e.style.display="none"},100)})};case"review":return self.initMap=function(){return r.fetchRestaurantFromURL(function(t,e){t?console.error(t):(r.setState({map:new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.latlng,scrollwheel:!1})}),r.fillBreadcrumb(),o.default.mapMarkerForRestaurant(r.state.restaurant,r.state.map)),google.maps.event.addListenerOnce(r.state.map,"idle",function(){setTimeout(function(){var t=document.getElementById("maincontent"),e=document.getElementById("overlay");t.style.visibility="visible",e.style.display="none"},100)})})}}};switch(c()[0]){case"/":var h=new n.default;f(h,"/"),a.addEventListener("change",function(){h.updateRestaurants()}),u.addEventListener("change",function(){h.updateRestaurants()});break;case"review":f(new i.default,"review")}var p=document.getElementById("toggle-map"),d=document.getElementById("map"),b=document.getElementById("map-container");d.style.display="none",p.addEventListener("click",function(t){t.preventDefault(),"none"===d.style.display?(d.style.display="block",b.style.display="block"):(d.style.display="none",b.style.display="none")}),navigator.serviceWorker&&navigator.serviceWorker.register("./"+("review"===c()[0]?"../../":"")+"sw.js").then(function(t){if(navigator.serviceWorker.controller)return t.installing?(console.log("Service worker installing"),l(t.installing)):t.waiting?console.log("Service worker installed"):t.active&&console.log("Service worker active at scope: "+t.scope),t.addEventListener("updatefound",function(){return l(t.installing)})}).catch(function(t){return console.error("ServiceWorker registration failed with error: "+t)})},{"./DBHelper":67,"./Restaurant":68,"./Review":69}],71:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.toast=function(t,e){var r=document.createElement("div"),n="toast"+String(Math.random()).split(".")[1];r.className="toast-message "+e,r.innerHTML='<div id="'+n+'" aria-label="You\'re offline" aria-live="assertive">'+t+"</div>",document.body.append(r);var i=document.getElementById(n);setTimeout(function(){i.parentElement.remove()},5e3)}},{}]},{},[70]);